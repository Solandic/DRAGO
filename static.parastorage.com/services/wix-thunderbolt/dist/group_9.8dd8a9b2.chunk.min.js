(self.webpackJsonp__wix_thunderbolt_app=self.webpackJsonp__wix_thunderbolt_app||[]).push([[1232],{45189:(e,t,a)=>{e.exports=a(10145)},10145:(e,t)=>{!function(e){"use strict";e.stringify=function e(t){function a(e){return/[^\w-.]/.test(e)?e.replace(/[^\w-.]/g,(function(e){return"$"===e?"!":(e=e.charCodeAt(0))<256?"*"+("00"+e.toString(16)).slice(-2):"**"+("0000"+e.toString(16)).slice(-4)})):e}var i;switch(typeof t){case"number":return isFinite(t)?"~"+t:"~null";case"boolean":return"~"+t;case"string":return"~'"+a(t);case"object":if(!t)return"~null";if(i=[],Array.isArray(t)){for(var o=0;o<t.length;o++)i[o]=e(t[o])||"~null";return"~("+(i.join("")||"~")+")"}for(var s in t)if(t.hasOwnProperty(s)){var n=e(t[s]);n&&i.push(a(s)+n)}return"~("+i.join("~")+")";default:return}};var t={true:!0,false:!1,null:null};e.parse=function(e){if(!e)return e;e=e.replace(/%(25)*27/g,"'");var a=0,i=e.length;function o(t){if(e.charAt(a)!==t)throw new Error("bad JSURL syntax: expected "+t+", got "+(e&&e.charAt(a)));a++}function s(){for(var t,o=a,s="";a<i&&"~"!==(t=e.charAt(a))&&")"!==t;)switch(t){case"*":o<a&&(s+=e.substring(o,a)),"*"===e.charAt(a+1)?(s+=String.fromCharCode(parseInt(e.substring(a+2,a+6),16)),o=a+=6):(s+=String.fromCharCode(parseInt(e.substring(a+1,a+3),16)),o=a+=3);break;case"!":o<a&&(s+=e.substring(o,a)),s+="$",o=++a;break;default:a++}return s+e.substring(o,a)}return function n(){var r,c,l;switch(o("~"),c=e.charAt(a)){case"(":if(a++,"~"===e.charAt(a))if(r=[],")"===e.charAt(a+1))a++;else do{r.push(n())}while("~"===e.charAt(a));else if(r={},")"!==e.charAt(a))do{r[s()]=n()}while("~"===e.charAt(a)&&++a);o(")");break;case"'":a++,r=s();break;default:for(l=a++;a<i&&/[^)~]/.test(e.charAt(a));)a++;var d=e.substring(l,a);if(/[\d\-]/.test(c))r=parseFloat(d);else if(void 0===(r=t[d]))throw new Error("bad value keyword: "+d)}return r}()},e.tryParse=function(t,a){try{return e.parse(t)}catch(e){return a}}}(t)},41253:(e,t,a)=>{"use strict";a.r(t),a.d(t,{AUTH_RESULT_REASON:()=>D.qd,BIEvents:()=>L,INTERACTIONS:()=>D.sH,PrivacyStatus:()=>we.lS,PrivacyStatusStatus:()=>A,Role:()=>N,SiteMembersApiSymbol:()=>v.Np,Status:()=>I,isLoginAcceptableError:()=>R.qi,isSignupAcceptableError:()=>R.NU,memberDetailsFromDTO:()=>R.Yv,page:()=>He,site:()=>xe});var i=a(77748),o=a(20590),s=a(32777),n=a(32166),r=a(87711),c=a(6623),l=a(9492),d=a(75396),u=a(10553),g=a(79435),m=a(39063),p=a(82658),h=a(46745),S=a(63386),b=a(71085),E=a(73896),C=a(45117),w=a(45156),P=a(45189),f=a.n(P);var y=a(62155),D=a(66397),v=a(19889);class _{constructor(e,t,a,i,o){this.propsStore=e,this.structureApi=t,this.siteScrollBlocker=a,this.browserWindow=i,this.cyclicTabbing=o,this.prevCompIds=[]}async displayDialog(e,t,a,i={},o){const s=async()=>{(0,p.fU)(this.browserWindow)||(this.activeElementBeforeShowDialog=this.browserWindow.document.activeElement);const i=(0,y.uniqueId)(v.RG);this.propsStore.update({[i]:{...t,...a}}),this.currentCompId&&this.cyclicTabbing.disableCyclicTabbing(this.currentCompId),this.cyclicTabbing.enableCyclicTabbing(i),await this.structureApi.addComponentToDynamicStructure(i,{componentType:e,components:[]}),this.currentCompId&&(o?this.prevCompIds.push(this.currentCompId):(this.structureApi.removeComponentFromDynamicStructure(this.currentCompId),this.siteScrollBlocker.setSiteScrollingBlocked(!1,this.currentCompId))),this.siteScrollBlocker.setSiteScrollingBlocked(!0,i),this.currentCompId=i},{shouldWaitForAppDidMount:n,registerToAppDidMount:r}=i;n&&r?r(s):await s()}hideDialog(e){if(this.currentCompId){if(this.removeComponentFromDynamicStructure(this.currentCompId),e)for(;this.prevCompIds.length>0;)this.removeComponentFromDynamicStructure(this.prevCompIds.pop());this.currentCompId=this.prevCompIds.pop()}(0,p.fU)(this.browserWindow)||(this.activeElementBeforeShowDialog?.focus(),this.activeElementBeforeShowDialog=null)}removeComponentFromDynamicStructure(e){this.structureApi.removeComponentFromDynamicStructure(e),this.siteScrollBlocker.setSiteScrollingBlocked(!1,e),this.cyclicTabbing.disableCyclicTabbing(e)}}var A,I,N;!function(e){e.UNKNOWN="UNKNOWN",e.PRIVATE="PRIVATE",e.PUBLIC="PUBLIC"}(A||(A={})),function(e){e.UNKNOWN="UNKNOWN",e.PENDING="PENDING",e.APPROVED="APPROVED",e.BLOCKED="BLOCKED",e.OFFLINE="OFFLINE"}(I||(I={})),function(e){e.UNDEFINED_ROLE="UNDEFINED_ROLE",e.MEMBER="MEMBER",e.OWNER="OWNER",e.CONTRIBUTOR="CONTRIBUTOR"}(N||(N={}));var R=a(65788),O=a(8145),T=a(98323);const L=({sessionManager:e,businessLogger:t,wixBiSession:a,viewMode:i,language:o})=>{const s=(t,s)=>({biToken:a.msId,context:t,ts:k(a),viewmode:i,visitor_id:e.getVisitorId(),site_member_id:e.getSiteMemberId(),vsi:a.viewerSessionId,site_settings_lng:o.siteLanguage,browser_lng:o.userLanguage,lng_mismatch:o.siteLanguage!==o.userLanguage,layout:s});return{loginOrSignUpDialogLoaded:(e,a="fullscreen")=>{t.logger.log({src:5,evid:658,...s(e,a)},{endpoint:"site-members"})},closingDialog:(e,a="fullscreen")=>{t.logger.log({src:5,evid:602,form_type:"default",...s(e,a)},{endpoint:"site-members"})},emailAuthSubmitClicked:(e,a)=>{t.logger.log({src:5,evid:603,form_type:"default",...s(e,a)},{endpoint:"site-members"})},siteMembersFeatureLoaded:()=>{t.logger.log({src:5,evid:698,...s()},{endpoint:"site-members"})},siteMembersSdkFeatureLoaded:()=>{t.logger.log({src:5,evid:699,...s()},{endpoint:"site-members"})},siteMembersEmailConfirmationNewMembersModalLoad:()=>{t.logger.log({src:5,evid:1809,...s()},{endpoint:"site-members"})},siteMembersEmailConfirmationSendCodeClick:()=>{t.logger.log({src:5,evid:1810,...s()},{endpoint:"site-members"})},siteMembersEmailConfirmationOnResendCodeClick:()=>{t.logger.log({src:5,evid:1811,...s()},{endpoint:"site-members"})},cachePrediction:()=>{t.logger.log({src:5,evid:1726,...s()},{endpoint:"site-members"})}}},k=e=>{const t=e.initialTimestamp||0;return Date.now()-t},U={isCloseable:!0,returnPages:!1};class M{constructor(e,t){this.shouldRunCustomPopupCloseCallback=!0,this.popups=e,this.onReset=t,this.config=U}async openPopupPage(e,t){const a=this.shouldRunCustomPopupCloseCallback;this.preventCustomPopupCloseCallback(),await(this.popups?.open(e,(()=>{this.shouldRunCustomPopupCloseCallback&&(this.rejectAuthenticationRequest(),t&&t())}))),this.shouldRunCustomPopupCloseCallback=a}preventCustomPopupCloseCallback(){this.shouldRunCustomPopupCloseCallback=!1}allowCustomPopupCloseCallback(){this.shouldRunCustomPopupCloseCallback=!0}assignRequestAuthenticationRejection(e){this.requestAuthenticationRejectInstance=this.requestAuthenticationRejectInstance||e}assignRequestAuthenticationResolveInstance(e){this.requestAuthenticationResolveInstance=this.requestAuthenticationResolveInstance||e}assignRequestAuthenticationPromise(e,t){this.requestAuthenticationRejectInstance=this.requestAuthenticationRejectInstance||t,this.requestAuthenticationResolveInstance=this.requestAuthenticationResolveInstance||e}rejectAuthenticationRequest(){this.requestAuthenticationRejectInstance&&(this.requestAuthenticationRejectInstance(D.qd.CANCELED),this.reset())}resolveAuthenticationRequest(e){this.requestAuthenticationRejectInstance&&(this.requestAuthenticationResolveInstance(e),this.reset())}setConfig({isCloseable:e=!0,returnPages:t=!1}){this.config={isCloseable:e,returnPages:t}}reset(){this.onReset?.(),this.requestAuthenticationRejectInstance=void 0,this.requestAuthenticationResolveInstance=void 0,this.config=U}}var V,B,F,q,W,$,x,H=a(15772),G=a(73699),j={},K={memberPrivacySettings:"_memberPrivacySettings"},J={updatedDate:"google.protobuf.Timestamp"};function Y(e){return(0,H.O2)(Object.assign(e,{domainToMappings:{"editor.wixapps.net":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"api._api_base_domain_":[{srcPath:"/members/v1/privacy-settings",destPath:""}],"manage._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"editor._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"blocks._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"create.editorx":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"www.wixapis.com":[{srcPath:"/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],_:[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"www._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"*.dev.wix-code.com":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"bo._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"wixbo.ai":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}],"apps._base_domain_":[{srcPath:"/_api/members/v1/privacy-settings",destPath:"/v1/privacy-settings"}]}}))}!function(e){e.UNKNOWN="UNKNOWN",e.VISIBLE_TO_MEMBERS_ONLY="VISIBLE_TO_MEMBERS_ONLY",e.VISIBLE_TO_ALL="VISIBLE_TO_ALL"}(V||(V={})),function(e){e.UNKNOWN="UNKNOWN",e.NO_ONE="NO_ONE",e.ANYONE="ANYONE"}(B||(B={})),function(e){e.UNKNOWN="UNKNOWN",e.ENABLED="ENABLED",e.DISABLED="DISABLED",e.PENDING="PENDING",e.DEMO="DEMO"}(F||(F={})),function(e){e.OTHER="OTHER",e.FROM_TEMPLATE="FROM_TEMPLATE",e.DUPLICATE_BY_SITE_TRANSFER="DUPLICATE_BY_SITE_TRANSFER",e.DUPLICATE="DUPLICATE",e.OLD_SITE_TRANSFER="OLD_SITE_TRANSFER",e.FLASH="FLASH"}(q||(q={})),function(e){e.UNKNOWN_NAMESPACE="UNKNOWN_NAMESPACE",e.WIX="WIX",e.SHOUT_OUT="SHOUT_OUT",e.ALBUMS="ALBUMS",e.WIX_STORES_TEST_DRIVE="WIX_STORES_TEST_DRIVE",e.HOTELS="HOTELS",e.CLUBS="CLUBS",e.ONBOARDING_DRAFT="ONBOARDING_DRAFT",e.DEV_SITE="DEV_SITE",e.LOGOS="LOGOS",e.VIDEO_MAKER="VIDEO_MAKER",e.PARTNER_DASHBOARD="PARTNER_DASHBOARD",e.DEV_CENTER_COMPANY="DEV_CENTER_COMPANY",e.HTML_DRAFT="HTML_DRAFT",e.SITELESS_BUSINESS="SITELESS_BUSINESS",e.CREATOR_ECONOMY="CREATOR_ECONOMY",e.DASHBOARD_FIRST="DASHBOARD_FIRST",e.ANYWHERE="ANYWHERE",e.HEADLESS="HEADLESS",e.ACCOUNT_MASTER_CMS="ACCOUNT_MASTER_CMS",e.RISE="RISE",e.BRANDED_FIRST="BRANDED_FIRST"}(W||(W={})),function(e){e.UNKNOWN="UNKNOWN",e.TRASH="TRASH",e.DELETED="DELETED",e.PENDING_PURGE="PENDING_PURGE"}($||($={})),function(e){e.UNKNOWN="UNKNOWN",e.ANONYMOUS_VISITOR="ANONYMOUS_VISITOR",e.MEMBER="MEMBER",e.WIX_USER="WIX_USER",e.APP="APP"}(x||(x={}));const z=e=>{const t=e.joinCommunityCheckedByDefault??!0,a=e.privacyNoteType??"CHECKBOX";return t?a:"CHECKBOX"},X=e=>"NOTE"===z(e)||(e.joinCommunityCheckedByDefault??!0),Q=async(e,t)=>{const{data:a}=await e.request(function(e){var t=(0,G.d)(j,{}),a=t.toJSON,i=t.fromJSON,o=(0,G.d)(K,{_memberPrivacySettings:J}).fromJSON;function s(t){var i=t.host,s=a(e);return{entityFqdn:"wix.members.v1.member_privacy_settings",method:"GET",methodFqn:"com.wixpress.members.memberprivacysettings.MemberPrivacySettingsService.GetMemberPrivacySettings",url:Y({protoPath:"/v1/privacy-settings",data:s,host:i}),params:(0,H.bU)(s),transformResponse:o}}return s.fromReq=i,s.__isAmbassador=!0,s}({}),{signedInstance:t});return a.memberPrivacySettings},Z={[I.APPROVED]:"ACTIVE",[I.PENDING]:"PENDING"},ee=({member:e,role:t})=>{return{id:e?.id??"",contactId:e?.contactId??"",loginEmail:e?.loginEmail??"",imageUrl:e?.profile?.photo?.url??"",nickname:e?.profile?.nickname??"",profilePrivacyStatus:e?.privacyStatus??"",slug:e?.profile?.slug??"",status:(i=e?.status,i?Z[i]??"APPLICANT":"APPLICANT"),creationDate:e?.createdDate??"",lastUpdateDate:e?.updatedDate??"",lastLoginDate:e?.lastLoginDate??"",emailVerified:e?.loginEmailVerified??!1,role:t??"MEMBER",owner:t===N.OWNER,firstName:e?.contact?.firstName??"",lastName:e?.contact?.lastName??"",memberName:(a=e?.contact,`${a?.firstName??""} ${a?.lastName??""}`.trim()),groups:void 0,emails:void 0,phones:void 0,addresses:void 0,labels:void 0,customFields:void 0};var a,i};var te=a(85583),ae={numValue:"DOUBLE",dateValue:"google.protobuf.Timestamp",listValue:"_commonListValue",mapValue:"_commonMapValue"},ie={value:"_commonCustomValue"},oe={value:"Map#_commonCustomValue"},se={value:"_customValue"},ne={numValue:"DOUBLE",dateValue:"google.protobuf.Timestamp",listValue:"_listValue",mapValue:"_mapValue"},re={createdDate:"google.protobuf.Timestamp",updatedDate:"google.protobuf.Timestamp",identityProfile:"_identityProfile"},ce={customFields:"_customField"},le={value:"_customValue"},de={},ue={},ge={value:"Map#_customValue"},me={body:"BYTES"},pe={profile:"_identityProfile"},he={identity:"_identity",additionalData:"Map#_commonCustomValue"};function Se(e){return(0,H.O2)(Object.assign(e,{domainToMappings:{_:[{srcPath:"/_api/iam/authentication",destPath:""}],"users._base_domain_":[{srcPath:"/iam/wix/google",destPath:"/v1/sso/callback/root/0e6a50f5-b523-4e29-990d-f37fa2ffdd69"},{srcPath:"/authentication",destPath:""}],"www.wixapis.com":[{srcPath:"/_api/iam/authentication",destPath:""}],"bo._base_domain_":[{srcPath:"/_api/iam/authentication",destPath:""}],"wixbo.ai":[{srcPath:"/_api/iam/authentication",destPath:""}],"dev._base_domain_":[{srcPath:"/_api/iam/authentication",destPath:""}],"manage._base_domain_":[{srcPath:"/_api/authentication",destPath:""}],"www._base_domain_":[{srcPath:"/_api/iam/authentication",destPath:""}]}}))}var be={},Ee={body:"BYTES"};function Ce(e){return(0,H.O2)(Object.assign(e,{domainToMappings:{"manage._base_domain_":[{srcPath:"/_api/cookie",destPath:""}],_:[{srcPath:"/_api/iam/cookie",destPath:""}],"bo._base_domain_":[{srcPath:"/_api/iam/cookie",destPath:""}],"wixbo.ai":[{srcPath:"/_api/iam/cookie",destPath:""}],"www._base_domain_":[{srcPath:"/_api/iam/cookie",destPath:""}],"dev._base_domain_":[{srcPath:"/_api/iam/cookie",destPath:""}]}}))}var we=a(82884),Pe={numValue:"DOUBLE",dateValue:"google.protobuf.Timestamp",listValue:"_commonListValue",mapValue:"_commonMapValue"},fe={value:"_commonCustomValue"},ye={value:"Map#_commonCustomValue"},De={value:"_customValue"},ve={numValue:"DOUBLE",dateValue:"google.protobuf.Timestamp",listValue:"_listValue",mapValue:"_mapValue"},_e={createdDate:"google.protobuf.Timestamp",updatedDate:"google.protobuf.Timestamp",identityProfile:"_identityProfile"},Ae={customFields:"_customField"},Ie={value:"_customValue"},Ne={value:"Map#_customValue"},Re={identity:"_identity",additionalData:"Map#_commonCustomValue"},Oe={};function Te(e){return(0,H.O2)(Object.assign(e,{domainToMappings:{"www.wixapis.com":[{srcPath:"/_api/iam/verification",destPath:""}],_:[{srcPath:"/_api/iam/verification",destPath:""}],"www._base_domain_":[{srcPath:"/_api/iam/verification",destPath:""}]}}))}function Le(e){var t=(0,G.d)(Oe,{}),a=t.toJSON,i=t.fromJSON,o=(0,G.d)(Re,{_commonCustomValue:Pe,_commonListValue:fe,_commonMapValue:ye,_customField:De,_customValue:ve,_identity:_e,_identityProfile:Ae,_listValue:Ie,_mapValue:Ne}).fromJSON;function s(t){var i=t.host,s=a(e);return{entityFqdn:"wix.iam.verification.v1.start_response",method:"POST",methodFqn:"wix.iam.verification.v1.VerificationService.VerifyDuringAuthentication",url:Te({protoPath:"/v1/auth/verify",data:s,host:i}),data:s,transformResponse:o}}return s.fromReq=i,s.__isAmbassador=!0,s}var ke=a(93425);const Ue=(e,t,a)=>{document.cookie=`${e}=;max-age=0`,document.cookie=`${e}=;max-age=0;path=${t}`,document.cookie=`${e}=;domain=${a};max-age=0`,document.cookie=`${e}=;domain=${a};max-age=0;path=${t}`},Me=(0,i.Og)([(0,i.KT)(o.YG,v.UU),(0,i.KT)(o._K,v.UU),(0,i.KT)(o.wk,v.UU),(0,i.KT)(o.AF,v.UU),s.F,n.Ht,n.TQ,S.i$,r.Ji,r.eZ,n.dn,n.RV,b.Ix,(0,i.lq)(E.j),b.$1,c.F,l.O$,(0,i.lq)(C.KK),(0,i.lq)(w.i),d.t7,u.n,(0,i.lq)(g.Z),(0,i.lq)(T.j),(0,i.lq)(O.U),(0,i.lq)(ke.gB)],((e,t,a,i,o,s,n,r,c,l,d,u,g,S,b,E,C,w,P={trackEvent:()=>0},v,A,I,O,T,k)=>{const U=(0,m.o)(),{loginSocialBarOnSite:V,protectedHomepage:F,smSessionCookie:q,memberInfoAppId:W,membersInfoAppDefId:$,smcollectionId:x,isTemplate:j}=e;let{sm_efCookie:K}=e;const J="22bef345-3c5b-4c18-b782-74d4085112ff",Y=r.getUserSession(),Z=()=>r.getAppInstanceByAppDefId(J)||"",Pe=()=>(0,R.YA)(r),fe=A["specs.thunderbolt.deprecateAppId"],ye=A["specs.ident.usePlatformizedSMAuth"],{smSettings:De,tpaAppDefinitionIds:ve,tpaApplicationIds:_e,tpaPageIds:Ae,policyLinks:Ie,translations:Ne}=t,Re=fe?ve[$]:W&&_e[W],{metaSiteId:Oe,externalBaseUrl:Te,siteId:ke,siteRevision:Me}=n.site,Ve=n.requestUrl,Be=n.viewMode,Fe=n.anywhereConfig?.siteId??ke,qe=n.anywhereConfig?.revision??Me,We=-1!==D.UG.findIndex((e=>u?.navigator?.userAgent?.includes(e))),$e=!We,xe=!We,He=`/_api/wix-sm-webapp/tokens/verify/${Oe}/${Fe}`,Ge=`${Te.replace(/\/$/,"")}/api/wix-sm/v1/authorize/${Fe}/pages`,je=`/_api/wix-sm-webapp/tokens/logout/${Oe}`,Ke=`/_api/wix-sm-webapp/member/changePasswordWithMailToken?metaSiteId=${Oe}&collectionId=${x}`,Je="/_api/iam/state-machine-service",Ye=De.smFirstDialogLogin?"login":"signup",{socialLoginFacebookEnabled:ze,socialLoginGoogleEnabled:Xe,termsOfUse:Qe,privacyPolicy:Ze,codeOfConduct:et,customSignUpPageId:tt,customSignInPageId:at}=De,{privacyNoteType:it,joinCommunityCheckedByDefault:ot}=(e=>({privacyNoteType:z(e),joinCommunityCheckedByDefault:X(e)}))(De);let{smToken:st}=e,nt={},rt=q,ct=null,lt=!1;const dt=e=>{ct=e},ut=()=>({registerToAppDidMount:dt,shouldWaitForAppDidMount:!lt}),gt={},mt={},pt=L({sessionManager:r,businessLogger:E,wixBiSession:C,viewMode:Be?.toUpperCase(),language:d});pt.siteMembersFeatureLoaded();const ht={},St=(0,R.I5)(o,{credentials:"same-origin",headers:{accept:"application/json","x-wix-site-revision":`${qe}`,"x-wix-client-artifact-id":"thunderbolt"}},Ve),bt=(0,te.u)({isSSR:!1,...A["specs.thunderbolt.siteMembersMultilingualLanguage"]&&d?.isMultilingualEnabled?{multilingualOptions:{isPrimaryLanguage:k?.isOriginalLanguage||!0,locale:k?.currentLanguage.locale??"en",lang:k?.currentLanguage.languageCode??"en"}}:{}}),Et=((e,t)=>{let a;return{canHavePublicMembers:async()=>a||(a=new Promise((async a=>{const i=await Q(e,t()),o=i?.publicMemberCandidates;a(o===B.ANYONE)})),a)}})(bt,Z),Ct=((e,t,a,i,o)=>new _(e,t,a,i,o))(c,l,S,u,O),wt=new URL(Ve).searchParams,Pt={};wt.forEach(((e,t)=>{Pt[t]=e}));const ft=(e=>{let{query:t}=e;const a=f().tryParse(null==t?void 0:t.headlessExternalUrls,{})??{};return null==a?void 0:a.headlessClientId})({query:Pt}),yt=((e,t,a,i,o,s)=>{let n;const r="/_serverless/collection-settings-facade/get-settings",c=async()=>n||e(s?`${r}?clientId=${s}`:r,{headers:{"Content-Type":"application/json",authorization:o()},credentials:"omit"}).then((e=>(n=e,n))),l=async()=>c().then((e=>e.collectionSettings));return{getSiteMembersSettings:l,getCaptchaSettings:()=>l().then(R.YG).catch((e=>(t.captureError(e,{tags:{feature:"site-members"}}),a.trackEvent((0,D.SU)(D.WW.ACTIONS.SETTINGS.FAIL)),{invisible:{login:!1,signup:!1},visible:{login:!1,signup:!0}}))),getEnabledConnections:e=>c().then((t=>t.enabledConnections.filter((({appDefId:t})=>!1!==e[t]))??[])),getLoginRedirectUrl:()=>c().then((e=>e.loginUrl)),getLogoutRedirectUrl:()=>c().then((e=>e.logoutUrl))}})(St,s,P,0,(()=>Z()),ft),Dt=(0,R.bR)(u),vt=(0,R.Ed)(u,U),_t=new M(w,(async()=>{const e=await yt.getCaptchaSettings();(e.invisible.login||e.invisible.signup)&&vt.hideCaptchaBadge()})),At=T?.getBsi(),It=At?At.split("|")[0]:"00000000-0000-0000-0000-000000000000",Nt=e=>{s.interactionStarted(D.sH.SOCIAL_APP_LOGIN_WITH_VENDOR(e))},Rt={appDidMount(){ct&&ct(),lt=!0},async handleSocialLoginResponse(e,t,a=!1){const i=D.UI[t]??t;s.interactionStarted(D.sH.SOCIAL_APP_LOGIN),s.interactionEnded(D.sH.SOCIAL_APP_LOGIN),s.interactionEnded(D.sH.SOCIAL_APP_LOGIN_WITH_VENDOR(i)),P.trackEvent((0,D.SU)(D.WW.ACTIONS.LOGIN.SUBMIT,i)),A["specs.thunderbolt.useNewPostLoginRedirect"]||(0,R._y)(u,Ve,{});const o=await Rt.handleIAMLoginResponseV1(e,a);return P.trackEvent((0,D.SU)(D.WW.ACTIONS.LOGIN.SUCCESS,i)),o},async handleIAMLoginResponseV1(e,t=!1){if(e.identity?.status?.name===we.EH.PENDING){if(ye){if(Ae[D.$m.ADMIN_APPROVAL])throw _t.rejectAuthenticationRequest(),await g.navigate(D.m2[D.$m.ADMIN_APPROVAL]),new Error(D.qd.CANCELED)}return Rt.showAdminApprovalDialog(e.identity.email?.address??"")}const a=(0,R.N3)(e),i=e.sessionToken,o=(0,R.FB)(e.additionalData?.protectedPages);if((0,R._y)(u,Ve,{sessionToken:i})&&A["specs.thunderbolt.useNewPostLoginRedirect"])return(0,R.yw)();const s=await Rt.applySessionToken(i,a,t&&!o);return{sessionToken:i,member:a,...t?{pages:o??s}:{}}},async promptLogin(e={},t=_t.config?.isCloseable??!0,a=_t.config?.returnPages??!1){const{mode:i,modal:o}=e,s="login"===(i??Ye),n=o?"popup":"fullscreen";return j?(await Rt.showNotificationDialog(Ne.templateNotificationTitle,Ne.templateNotificationMessage,Ne.containerOk),Promise.reject(D.qd.CANCELED)):(vt.loadScript(d.userLanguage,D.c8),s?Rt.showLoginDialog({isCloseable:t,displayMode:n,returnPages:a}):Rt.showSignUpDialog({isCloseable:t,displayMode:n,returnPages:a}))},promptForgotPassword:(e=!0)=>new Promise(((t,a)=>{_t.assignRequestAuthenticationPromise(t,a);const i={isCloseable:e,directionByLanguage:d.directionByLanguage,translations:Ne},o={async onCloseDialogCallback(){(0,R.Fy)(Ve,u),pt.closingDialog("RequestResetPassword"),Ct.hideDialog(),_t.rejectAuthenticationRequest()},onSubmitCallback:e=>Rt.sendResetPasswordEmail(e).then((async()=>{const e=()=>{(0,R.Fy)(Ve,u),_t.resolveAuthenticationRequest(),a(D.qd.CANCELED)};Rt.showNotificationDialog(Ne.resetPasswordCheckEmailTitle,Ne.resetPasswordCheckEmailText,Ne.resetPasswordOk,e,e)}))},s=ut();if(ye){const e=Ae[D.$m.FORGOT_PASSWORD];if(e)return w?.open(e,(()=>{(0,R.Fy)(Ve,u),_t.resolveAuthenticationRequest(),a(D.qd.CANCELED)})).then((()=>{Ct.hideDialog(!0)}))}Ct.displayDialog("RequestPasswordResetDialog",i,o,s)})),async requestAuthentication(e={}){if(rt)return{success:!0,token:rt,reason:D.qd.ALREADY_LOGGED_IN};try{const t=!F,{sessionToken:a}=await Rt.promptLogin(e,t);return{success:!0,token:a,reason:D.qd.SUCCESS}}catch(e){return{success:!1,reason:e}}},async requestAuthorizedPages(e={}){if(st){return{success:!0,pages:await Rt.authorizeMemberPagesBySignedInstance(Z())}}try{const t=!F;_t.setConfig({isCloseable:t,returnPages:!0});const a=await Rt.promptLogin(e,t,!0);return _t.reset(),{success:!0,pages:a.pages}}catch(e){return{success:!1,reason:e}}},async applySessionToken(e,t,a=!1){if((0,p.fU)(u))throw D.Nw;s.interactionStarted(D.sH.VERIFY_TOKEN);const o=await bt.request(function(e){var t=(0,G.d)(be,{}),a=t.toJSON,i=t.fromJSON,o=(0,G.d)(Ee,{}).fromJSON;function s(t){var i=t.host,s=a(e);return{entityFqdn:"wix.iam.cookie.v1.cookie",method:"POST",methodFqn:"wix.iam.cookie.v1.CookieService.CreateSessionCookie",url:Ce({protoPath:"/v1/createSessionCookie",data:s,host:i}),data:s,transformResponse:o,fallback:[{method:"POST",url:Ce({protoPath:"/v1/createSessionCookie",data:s,host:i}),data:s}]}}return s.fromReq=i,s.__isAmbassador=!0,s}({sessionToken:e,protectedPages:a}),{signedInstance:Z()}).then((e=>e.data)).catch((e=>{throw e.response?.data??e}));var n;if(s.interactionEnded(D.sH.VERIFY_TOKEN),await r.loadNewSession({reason:"memberLogin"}),st=r.getSmToken(),rt=e,nt=t??await Rt.getMemberDetails(),await(n=nt,Promise.all(Object.entries(gt).map((async([e,t])=>{try{if("$$$timeout$$$"===await Promise.race([t(n),(0,R.yy)(3e3).then((()=>"$$$timeout$$$"))]))throw new Error(`callback ${e} timed out`)}catch(e){s.captureError(e,{tags:{feature:"site-members"}})}})))),i.export({memberDetails:nt}),a){return(0,R.FB)(o?.protectedPages)}},async authorizeMemberPagesByCookie(){const e=(0,p.fU)(u)?{headers:{cookie:`smSession=${q}`}}:void 0,{authorizedPages:t}=await St(Ge,e);return t},async authorizeMemberPagesByToken(e){if(e===q)return this.authorizeMemberPagesByCookie();const{payload:t}=await St(He,{method:"POST",body:`token=${e}`}),{pages:a}=t;return a},async authorizeMemberPagesBySignedInstance(e){const t={headers:{authorization:e}},{authorizedPages:a}=await St(Ge,t);return a},async getMemberDetails(e=!1){if(nt.id&&!e)return nt;if(!r.getSiteMemberId())return null;const t=await(A["specs.thunderbolt.preventGetMemberDetailsWaterfall"]?(async()=>{const[e,t]=await Promise.all([(0,R.hv)((async()=>(await St("/_api/members/v1/members/my?fieldsets=FULL",{headers:{authorization:r.getAppInstanceByAppDefId(J)??""}})).member),(()=>null)),(0,R.hv)((async()=>(await St(`/api/wix-sm/v1/members/${r.getSiteMemberId()}/role`,{headers:{authorization:r.getAppInstanceByAppDefId(J)??""}})).role),(()=>N.MEMBER))]);return e&&t?ee({member:e,role:t}):null})():(async()=>{let e;try{const t=await St("/_api/members/v1/members/my?fieldsets=FULL",{headers:{authorization:r.getAppInstanceByAppDefId(J)??""}});e=t.member}catch(e){return null}const{role:t}=await(0,R.hv)((()=>St(`/api/wix-sm/v1/members/${e?.id}/role`,{headers:{authorization:r.getAppInstanceByAppDefId(J)??""}})),(()=>({role:N.MEMBER})));return ee({member:e,role:t})})());return t?((e=>{const t="__wix.memberDetails",a=u?.localStorage?.getItem?.(t),i=JSON.stringify(e);if(a!==i)return pt.cachePrediction();u?.localStorage.setItem(t,i)})(t),nt=t,i.export({memberDetails:nt}),e&&await(a=nt,Promise.all(Object.values(ht).map((async e=>{try{await e(a)}catch(e){s.captureError(e,{tags:{feature:"site-members"}})}})))),nt):null;var a},async sendForgotPasswordMail(e){return this.sendResetPasswordEmail(e)},async sendResetPasswordEmail(e){s.interactionStarted(D.sH.RESET_PASSWORD);const t=d.userLanguage,a={url:(0,R.g9)(Ve)??Ve},i=JSON.stringify({language:t,email:e,redirect:a}),o={"Content-Type":"application/json",authorization:Z()};await St("/_api/iam/recovery/v1/send-email",{headers:o,method:"POST",body:i}),s.interactionEnded(D.sH.RESET_PASSWORD)},async sendSetPasswordEmail(e,t){const a=await St("/_api/wix-sm-webapp/members/v1/auth/members/send-set-password-email",{method:"POST",headers:{"Content-Type":"application/json",authorization:Z()},body:JSON.stringify({email:e,...t?.hideIgnoreMessage?{hideIgnoreMessage:t.hideIgnoreMessage}:{}})});return!!a?.accepted},async changePassword(e,t){const a=encodeURIComponent(e),i=t.startsWith(D.Zq),o=i?"/_api/iam/recovery/v1/recover":Ke,s=i?JSON.stringify({password:e,recovery_token:t}):`newPassword=${a}&forgotPasswordToken=${t}`,n=i?{"Content-Type":"application/json",authorization:Z()}:void 0;await St(o,{method:"POST",headers:n,body:s})},async sendEmailVerification(e){return this.resendEmailVerification(e)},async resendEmailVerification(e){await St(`/_api/wix-sm-webapp/tokens/email/resend/${e}`)},async logout(e){if(!st)return!1;if(A["specs.thunderbolt.logoutOnIAM"]?await bt.request(function(e){var t=(0,G.d)(ue,{}),a=t.toJSON,i=t.fromJSON,o=(0,G.d)(me,{}).fromJSON;function s(t){var i=t.host,s=a(e);return{entityFqdn:"wix.iam.authentication.v1.authentication",method:"GET",methodFqn:"wix.iam.authentication.v1.AuthenticationService.Logout",url:Se({protoPath:"/v1/logout",data:s,host:i}),params:(0,H.bU)(s),transformResponse:o}}return s.fromReq=i,s.__isAmbassador=!0,s}({}),{signedInstance:Z()}).catch((()=>{P.trackEvent((0,D.SU)(D.WW.ACTIONS.LOGOUT.FAIL))})):await St(je,{method:"POST"}).catch((()=>{P.trackEvent((0,D.SU)(D.WW.ACTIONS.LOGOUT.FAIL))})),await Promise.all(Object.entries(mt).map((async([e,t])=>{try{if("$$$timeout$$$"===await Promise.race([t(),(0,R.yy)(3e3).then((()=>"$$$timeout$$$"))]))throw new Error(`callback ${e} timed out`)}catch(e){s.captureError(e,{tags:{feature:"site-members"}})}}))),e){const t=`./${e.replace(/^\//,"")}`;await g.navigate(t)}const t=await Rt.getLogoutUrl();return t?u?.location.replace(t):(0,p.fU)(u)||u.document.location.reload(),!(!e&&!t)},registerToUserLogin:(e,t=(0,y.uniqueId)("callback"))=>(gt[t]=e,t),unRegisterToUserLogin(e){delete gt[e]},registerToMemberLogout(e){const t=(0,y.uniqueId)("logout_callback");return mt[t]=e,t},unRegisterToMemberLogout(e){delete mt[e]},registerToMemberDetailsRefresh(e){const t=(0,y.uniqueId)("mdrcb");return ht[t]=e,t},unRegisterToMemberDetailsRefresh(e){delete ht[e]},async showWelcomeDialog(e=!0){const t={isCloseable:e,translations:Ne},a=b.getParsedUrl(),i={onCloseDialogCallback(){(0,R.Fy)(Ve,u),pt.closingDialog("WelcomeDialog");const e=new URL(Ve).hostname,t=0===e.indexOf("www")?e.substr(3):e;Ue("sm_ef","/",t),K="",Ct.hideDialog(),g.navigate(a.href)},onSubmitCallback(){const e=new URL(Ve).hostname,t=0===e.indexOf("www")?e.substr(3):e;Ue("sm_ef","/",t),K="",Ct.hideDialog(),Re&&g.navigate("./account/my-account"),g.navigate(a.href)}};s.interactionStarted(D.sH.WELCOME_DIALOG),s.interactionEnded(D.sH.WELCOME_DIALOG),Ct.displayDialog("WelcomeDialog",t,i)},async showNoPermissionsToPageDialog(e){if(ye){if(Ae[D.$m.ACCESS_RESTRICTED])return void g.navigate(D.m2[D.$m.ACCESS_RESTRICTED])}const t={onCloseDialogCallback(){(0,R.Fy)(Ve,u),Ct.hideDialog(),e&&e()},onSwitchAccountLinkClick(){Rt.logout()}};Ct.displayDialog("NoPermissionsToPageDialog",{translations:Ne},t)},async navigateToResetPasswordPage(e){if(Ae[D.$m.RESET_PASSWORD]){const t=`${D.m2[D.$m.RESET_PASSWORD]}?resetPasswordToken=${e}`;return await g.navigate(t)}this.showResetPasswordDialog(e)},async showResetPasswordDialog(e){const t=()=>{const e=b.getParsedUrl();return e.searchParams.delete("forgotPasswordToken"),e.searchParams.delete("forgotPasswordLang"),b.pushUrlState(e),e},a={isCloseable:!0,isTermsOfUseNeeded:!(!Qe?.enabled||!Ie.termsOfUse),isPrivacyPolicyNeeded:!(!Ze?.enabled||!Ie.privacyPolicy),termsOfUseLink:Ie.termsOfUse,privacyPolicyLink:Ie.privacyPolicy,directionByLanguage:d.directionByLanguage,translations:Ne},i={onCloseDialogCallback(){(0,R.Fy)(Ve,u),pt.closingDialog("ResetPasswordDialog");const e=t();Ct.hideDialog(),g.navigate(e.href)},async onSubmitCallback(i){try{await Rt.changePassword(i,e),Rt.showNotificationDialog(Ne.resetPasswordSuccessTitle,"",Ne.containerOk,(async()=>{if(e.startsWith(D.Zq)){const e=new URL(Ve).searchParams.get("redirectUrl");if(e)return u?.location.replace(e)}const a=t();await Rt.showLoginDialog(),g.navigate(a.href)}))}catch(e){const t=(0,R.E2)(e).toString();if(t!==D.OQ.RESET_PASSWORD_TOKEN_EXPIRED&&t!==D.OQ.NEW_RESET_PASSWORD_TOKEN_EXPIRED)throw e;if(ye){if(Ae[D.$m.EXPIRED_TOKEN])return void await g.navigate(D.m2[D.$m.EXPIRED_TOKEN])}Rt.showNotificationDialog(Ne.passwordHasExpiredTitle,Ne.passwordHasExpiredText,Ne.passwordHasExpiredOk,(()=>Rt.promptForgotPassword(a.isCloseable).then((()=>{const e=b.getParsedUrl();g.navigate(e.href)}))))}}};Ct.displayDialog("ResetPasswordDialog",a,i,ut())},async showLoggedInResetPasswordDialog(){const e={isCloseable:!0,directionByLanguage:d.directionByLanguage,translations:Ne},t={onCloseDialogCallback(){pt.closingDialog("LoggedInResetPasswordDialog"),Ct.hideDialog()},async onSubmitCallback(){}};Ct.displayDialog("LoggedInResetPasswordDialog",e,t,ut())},async showLoginDialog(e={},t){const{returnPages:a,isCloseable:i,displayMode:o}={isCloseable:!0,displayMode:"fullscreen",returnPages:!1,...e},n=await yt.getCaptchaSettings();return vt.setCaptchaBadgeVisibility(n.invisible.login),at&&w?.isLightbox(at)?Rt.showCustomAuthenticationDialog(at,a):new Promise((async(e,r)=>{_t.assignRequestAuthenticationPromise(e,r);const c="Enabled"===A["specs.ShouldForceCaptchaVerificationOnLoginSpec"]||n.visible.login,[l,g]=(0,y.partition)(await Rt.getConnections(),{appDefId:D.ch.PASSWORD}),m=await Rt.getLoginUrl(),p={bsi:It,displayMode:o,language:d.userLanguage,directionByLanguage:d.directionByLanguage,isCloseable:i,smCollectionId:x,svSession:Y,biVisitorId:Pe(),metaSiteId:Oe,isEmailLoginEnabled:l.length>0,idps:g,shouldForceCaptchaVerification:!n.invisible.login&&c,isSocialAuthSupported:$e,serverError:t,reportBi:E.reportBi,translations:Ne,externalBaseUrl:Rt.getExternalBaseUrl(),headlessRedirectUrl:m},S={onCloseDialogCallback(){(0,R.Fy)(Ve,u),Ct.hideDialog(),pt.closingDialog("MemberLoginDialog",o),_t.rejectAuthenticationRequest()},submit:(t,i,n)=>(s.interactionStarted(D.sH.DEFAULT_LOGIN),pt.emailAuthSubmitClicked("MemberLoginDialog",o),Rt.login(t,i,n,a,void 0,!0).then((t=>{s.interactionEnded(D.sH.DEFAULT_LOGIN),Ct.hideDialog(),e(t)})).catch((e=>{throw(0,R.qi)(e)&&s.interactionEnded(D.sH.DEFAULT_LOGIN),e}))),onForgetYourPasswordClick(){Rt.promptForgotPassword(i)},onSwitchDialogLinkClick(){Rt.showSignUpDialog({isCloseable:i,displayMode:o,returnPages:a}).then(e,(()=>{_t.rejectAuthenticationRequest()}))},onBackendSocialLogin:(t,i)=>Rt.handleSocialLoginResponse(t,i,a).then((t=>{Ct.hideDialog(),e(t)})),getHostReadyPayload:()=>({visitorId:Pe(),svSession:Y}),openCaptcha:(0,h.V1)({captcha:I,userLanguage:d.userLanguage}),reportSocialAuthStarted:Nt};pt.loginOrSignUpDialogLoaded("MemberLoginDialog",o),await Ct.displayDialog("MemberLoginDialog",p,S,ut()),Rt.closeCustomAuthenticationDialogs(!0)}))},async showSignUpDialog(e={},t){const{returnPages:a,isCloseable:i,displayMode:o}={isCloseable:!0,displayMode:"fullscreen",returnPages:!1,...e},n=await yt.getCaptchaSettings();if(vt.setCaptchaBadgeVisibility(n.invisible.signup),tt&&w?.isLightbox(tt))return Rt.showCustomAuthenticationDialog(tt,a);const r="Enabled"!==A["specs.ShouldPassCaptchaVerificationOnSignupSpec"]&&"Enabled"===A["specs.ShouldForceCaptchaVerificationOnSignupSpec"];return new Promise((async(e,c)=>{const l=r||n.visible.signup&&"Enabled"!==A["specs.ShouldPassCaptchaVerificationOnSignupSpec"],[g,m]=(0,y.partition)(await Rt.getConnections(),{appDefId:D.ch.PASSWORD}),p=await Rt.getLoginUrl();_t.assignRequestAuthenticationPromise(e,c);const S={bsi:It,displayMode:o,language:d.userLanguage,directionByLanguage:d.directionByLanguage,isCloseable:i,smCollectionId:x,biVisitorId:Pe(),svSession:Y,metaSiteId:Oe,isSocialAuthSupported:$e,isEmailLoginEnabled:g.length>0,idps:m,isCommunityInstalled:await Et.canHavePublicMembers(),privacyNoteType:it,joinCommunityCheckedByDefault:ot,isTermsOfUseNeeded:!(!Qe?.enabled||!Ie.termsOfUse),isPrivacyPolicyNeeded:!(!Ze?.enabled||!Ie.privacyPolicy),isCodeOfConductNeeded:!(!et?.enabled||!Ie.codeOfConduct),shouldForceCaptchaVerification:!n.invisible.signup&&l,termsOfUseLink:Ie.termsOfUse,privacyPolicyLink:Ie.privacyPolicy,codeOfConductLink:Ie.codeOfConduct,serverError:t,reportBi:E.reportBi,translations:Ne,externalBaseUrl:Rt.getExternalBaseUrl(),headlessRedirectUrl:p},b={onCloseDialogCallback(){(0,R.Fy)(Ve,u),Ct.hideDialog(),pt.closingDialog("SignUpDialog",o),_t.rejectAuthenticationRequest()},async submit(t,i,n){let r;if(S.isCommunityInstalled){r=("boolean"==typeof n?n:n.isCommunityChecked)?we.lS.PUBLIC:we.lS.PRIVATE}const c="boolean"==typeof n?void 0:n?.recaptchaToken;return s.interactionStarted(D.sH.DEFAULT_SIGNUP),pt.emailAuthSubmitClicked("SignUpDialog",o),Rt.register(t,i,void 0,r,!0,a,c,void 0).then((t=>{s.interactionEnded(D.sH.DEFAULT_SIGNUP);const{member:i,sessionToken:o,pages:n}=t;o&&(Ct.hideDialog(!0),e({member:i,sessionToken:o,...a?{pages:n}:{}}))})).catch((e=>{throw(0,R.NU)(e)&&s.interactionEnded(D.sH.DEFAULT_SIGNUP),e}))},onSwitchDialogLinkClick(){Rt.showLoginDialog({isCloseable:i,displayMode:o,returnPages:a}).then(e,(()=>{_t.rejectAuthenticationRequest()}))},onBackendSocialLogin:(t,i)=>Rt.handleSocialLoginResponse(t,i,a).then((t=>{Ct.hideDialog(),e(t)})),getHostReadyPayload:()=>({visitorId:Pe(),svSession:Y}),openCaptcha:(0,h.V1)({captcha:I,userLanguage:d.userLanguage}),reportSocialAuthStarted:Nt};pt.loginOrSignUpDialogLoaded("SignUpDialog",o),await Ct.displayDialog("SignUpDialog",S,b,ut()),Rt.closeCustomAuthenticationDialogs(!0)}))},async hideAuthDialog(){console.warn("hideAuthDialog is not supported")},async showNotificationDialog(e,t,a,i=(()=>0),o=(()=>0)){const s={isCloseable:!0,title:e,description:t,okButtonText:a,translations:Ne},n={onCloseDialogCallback(){(0,R.Fy)(Ve,u),pt.closingDialog("NotificationDialog"),Ct.hideDialog(),o()},onOkButtonClick(){Ct.hideDialog(),i()}};await Ct.displayDialog("NotificationDialog",s,n)},showConfirmationEmailDialog:async(e,t=!0)=>new Promise(((a,i)=>{const o={isCloseable:!0,isSignUp:t,translations:Ne},s={onCloseDialogCallback(){(0,R.Fy)(Ve,u),pt.closingDialog("ConfirmationEmailDialog"),Ct.hideDialog(),_t.rejectAuthenticationRequest(),i(D.qd.CANCELED)},async onResendConfirmationEmail(){await Rt.resendEmailVerification(e),await Rt.showConfirmationEmailDialog(e,!1).catch(i)}};Ct.displayDialog("ConfirmationEmailDialog",o,s)})),showAdminApprovalDialog:async e=>new Promise(((t,a)=>{const i=()=>{(0,R._y)(u,Ve,{error:R.Mi.ACCESS_DENIED}),_t.rejectAuthenticationRequest(),a(D.qd.CANCELED),Rt.closeCustomAuthenticationDialogs(!1)};Rt.showNotificationDialog("",`${Ne.applySuccess1} ${Ne.applySuccess2}`.replace("{0}",e),Ne.containerOk,i,i)})),async showCustomAuthenticationDialog(e,t=!1){if(!w)throw new Error("popup unavailable");return new Promise((async(a,i)=>{_t.assignRequestAuthenticationPromise(a,i);const o=Rt.registerToUserLogin((async()=>{_t.resolveAuthenticationRequest({member:nt,sessionToken:rt,...t?{pages:await Rt.authorizeMemberPagesBySignedInstance(Z())}:{}}),Rt.unRegisterToUserLogin(o),w.getCurrentLightboxId()===e&&w.close()}),"customAuthCbId");await _t.openPopupPage(e,(()=>{Rt.unRegisterToUserLogin(o)})),Ct.hideDialog()}))},async closeCustomAuthenticationDialogs(e=!1){const t=w?.getCurrentLightboxId();t&&[tt,at].includes(t)&&(e&&_t.preventCustomPopupCloseCallback(),await w.close(),_t.allowCustomPopupCloseCallback())},getForgotPasswordToken:()=>new URL((0,p.fU)(u)?Ve:u.location.href).searchParams.get("forgotPasswordToken"),shouldDisplayWelcomeDialog:()=>K&&Re,async verifyEmail(e){try{const t=a.get().emailConfirmationStateToken,i=await bt.request(Le({stateToken:t,code:e}),{signedInstance:Z()});a.update((e=>({...e,emailConfirmationResponse:i?.data})))}catch(e){throw(0,R.E2)(e.response?.data)}},async resendVerificationCodeEmail(){pt.siteMembersEmailConfirmationOnResendCodeClick();const e=a.get().emailConfirmationStateToken,t=await St(`${Je}/v1/proceed`,{method:"POST",headers:{"Content-Type":"application/json",authorization:Z()},body:JSON.stringify({stateToken:e})});a.update((e=>({...e,emailConfirmationStateToken:t.stateToken})))},showVerificationCodeDialog:async(e,t=!0)=>new Promise((async(a,i)=>{s.interactionStarted(D.sH.VERIFICATION_CODE),pt.siteMembersEmailConfirmationNewMembersModalLoad(),_t.assignRequestAuthenticationPromise(a,i);const o={language:d.userLanguage,directionByLanguage:d.directionByLanguage,isCloseable:_t.config?.isCloseable??!0,displayMode:"customPopup",email:e?.email,error:e?.error,translations:Ne,isAuthV2Enabled:!0,stateToken:e?.stateToken,isVerificationCodeDialogNewLogic:A["specs.thunderbolt.verificationCodeDialogNewLogic"]},n={async onResendVerificationCodeEmail(){pt.siteMembersEmailConfirmationOnResendCodeClick(),await St(`${Je}/v1/proceed`,{method:"POST",headers:{"Content-Type":"application/json",authorization:Z()},body:JSON.stringify({stateToken:e.stateToken})})},onCloseDialogCallback(){pt.closingDialog("VerificationCode"),(0,R.Fy)(Ve,u),Ct.hideDialog(),_t.rejectAuthenticationRequest(),i(D.qd.CANCELED)},async onSubmitCallback(t){pt.siteMembersEmailConfirmationSendCodeClick();if(A["specs.thunderbolt.verificationCodeDialogNewLogic"])try{const a={stateToken:e.stateToken||"",code:t},i=await bt.request(Le(a),{signedInstance:Z()});return i?.data}catch(e){const t=(0,R.E2)(e.response?.data);if(t===D.qd.CANCELED)return i(t);throw t}a(t)},onSuccessCallback:e=>{Ct.hideDialog(),a(e)}};s.interactionEnded(D.sH.VERIFICATION_CODE),Ct.displayDialog("VerificationCodeDialog",o,n,void 0,t)})),async appWillMount(){V&&await Rt.getMemberDetails();switch(new URL(n.requestUrl).searchParams.get("showDialog")){case"MemberLoginDialog":Rt.showLoginDialog();break;case"SignUpDialog":Rt.showSignUpDialog();break;case"RequestPasswordResetDialog":Rt.promptForgotPassword();break;case"ResetPasswordDialog":Rt.showResetPasswordDialog("faketoken");break;case"LoggedInResetPasswordDialog":Rt.showLoggedInResetPasswordDialog();break;case"WelcomeDialog":Rt.showWelcomeDialog();break;case"NoPermissionsToPageDialog":Rt.showNoPermissionsToPageDialog();break;case"NotificationDialog":Rt.showNotificationDialog("title","description","ok");break;case"ConfirmationEmailDialog":Rt.showConfirmationEmailDialog("fakemember");break;case"VerificationCodeDialog":Rt.showVerificationCodeDialog({email:"testEmail@test.com"});break;case"ExpiredResetPasswordDialog":Rt.showNotificationDialog(Ne.passwordHasExpiredTitle,Ne.passwordHasExpiredText,Ne.passwordHasExpiredOk,(()=>Rt.promptForgotPassword(!1).then((()=>{const e=b.getParsedUrl();g.navigate(e.href)}))))}},pageWillUnmount({pageId:e}){[tt,at].includes(e)||Ct.hideDialog()},getSocialAuthComponentProps:()=>(0,R._G)({config:e,viewerModel:n,sessionManager:r,bsiManager:T,handleSocialLoginResponse:Rt.handleSocialLoginResponse,isSocialAuthSupported:xe,captcha:I,userLanguage:d.userLanguage,reportBi:E.reportBi,reportSocialAuthStarted:Nt,useNewSocialFlow:!0,translations:Ne}),async getConnections(){const e={[D.ch.FACEBOOK]:!0,[D.ch.GOOGLE]:!0,[D.ch.APPLE]:!1};return yt.getEnabledConnections(e).then((e=>e.map((({id:e,appDefId:t,displayName:a})=>({id:e,appDefId:t,name:a})))))},getLoginUrl(){if(ft&&A["specs.thunderbolt.shouldFetchLoginUrlByClientId"])return yt.getLoginRedirectUrl()},getLogoutUrl(){if(ft)return yt.getLogoutRedirectUrl()},getExternalBaseUrl:()=>A["specs.thunderbolt.shouldUseExternalBaseUrl"]?Te:void 0,async register(e,t,a,i,o,n,r,c){n=n??!1;try{const l=await yt.getCaptchaSettings();if(l.visible.signup&&"Enabled"!==A["specs.ShouldPassCaptchaVerificationOnSignupSpec"]&&!r&&!c?.otp&&!c?.verificationId)throw D.pH;s.interactionStarted(D.sH.CODE_SIGNUP),P.trackEvent((0,D.SU)(D.WW.ACTIONS.SIGNUP.SUBMIT));const d=w?.getCurrentLightboxId(),g=v.getCurrentRouteInfo()?.pageId,m=o||tt&&d&&tt===d||tt&&g&&tt===g,p=l.invisible.signup&&m?await Dt(D.MA.SIGNUP):void 0,h=A["specs.thunderbolt.convertBirthdateToISOString"],S={profile:{...(0,R.y0)(a||{},h),privacyStatus:i,emails:[e]},loginId:{email:e},password:t,captchaTokens:[...r?[{Recaptcha:r}]:[],...p?[{InvisibleRecaptcha:p}]:[]]},b=await bt.request(function(e){var t=(0,G.d)(pe,{_customField:se,_customValue:ne,_identityProfile:ce,_listValue:le,_mapValue:ge}),a=t.toJSON,i=t.fromJSON,o=(0,G.d)(he,{_commonCustomValue:ae,_commonListValue:ie,_commonMapValue:oe,_customField:se,_customValue:ne,_identity:re,_identityProfile:ce,_listValue:le,_mapValue:ge}).fromJSON;function s(t){var i=t.host,s=a(e);return{entityFqdn:"wix.iam.authentication.v1.authentication",method:"POST",methodFqn:"wix.iam.authentication.v1.AuthenticationService.RegisterV2",url:Se({protoPath:"/v2/register",data:s,host:i}),data:s,transformResponse:o}}return s.fromReq=i,s.__isAmbassador=!0,s}(S),{signedInstance:Z()}).then((e=>e.data)).catch((e=>{throw e.response?.data??e}));s.interactionEnded(D.sH.CODE_SIGNUP);const E=await Rt.getStateMachine(b,e),C=E?.additionalData?.protectedPages,f=(0,R.FB)(C),y=(0,R.$e)(E);if((0,R._y)(u,Ve,{sessionToken:E?.sessionToken})&&A["specs.thunderbolt.useNewPostLoginRedirect"])return(0,R.yw)();const _=await Rt.applySessionToken(E?.sessionToken,y,n&&!f),I=f??_;P.trackEvent((0,D.SU)(D.WW.ACTIONS.SIGNUP.SUCCESS)),P.trackEvent({eventName:"CompleteRegistration",params:{origin:"Site members",method:"Wix"}});const N=E?.sessionToken;return{member:y,status:y.status,sessionToken:N,...n&&I?{pages:I}:{}}}catch(e){throw(0,R.NU)(e)?s.interactionEnded(D.sH.CODE_SIGNUP):P.trackEvent((0,D.SU)(D.WW.ACTIONS.SIGNUP.FAIL)),e}},async getStateMachine(e,t){const i=e?.state;if(i===we.Gd.REQUIRE_OWNER_APPROVAL){if(!ye)return Rt.showAdminApprovalDialog(t);{const e=Ae[D.$m.ADMIN_APPROVAL];if(e)return new Promise(((a,i)=>{w?.open(e,(()=>{(0,R._y)(u,Ve,{error:R.Mi.ACCESS_DENIED}),_t.rejectAuthenticationRequest(),i(D.qd.CANCELED),Rt.closeCustomAuthenticationDialogs(!1)}),{email:t}).then((()=>{Ct.hideDialog(!0)}))}))}}if(i===we.Gd.REQUIRE_EMAIL_VERIFICATION){if(ye){const i=Ae[D.$m.EMAIL_CONFIRMATION];if(i){const o=await new Promise((o=>{a.update((t=>({...t,emailConfirmationStateToken:e?.stateToken??""})));w?.open(i,(()=>{const e=a.get().emailConfirmationResponse;e.state!==we.Gd.SUCCESS&&e.state!==we.Gd.REQUIRE_OWNER_APPROVAL&&this.promptLogin({mode:"signup"}),o(e)}),{email:t}).then((()=>{Ct.hideDialog(!0)}))}));return this.getStateMachine(o,t)}}const i=A["specs.thunderbolt.verificationCodeDialogNewLogic"],o=e?.stateToken??"";if(i){const e=await Rt.showVerificationCodeDialog({email:t,stateToken:o});return Rt.getStateMachine(e,t)}return Rt.recurciveEmailVerification(t,e?.stateToken).then((e=>(Ct.hideDialog(),Rt.getStateMachine(e,t))))}return e},async recurciveEmailVerification(e,t,a,i,o){try{const s={stateToken:t||"",code:o??await Rt.showVerificationCodeDialog({email:e,stateToken:t,error:i},!a)};return(await bt.request(Le(s),{signedInstance:Z()})).data}catch(a){if(a===D.qd.CANCELED)throw a;const i=a?.details?.applicationError?.code??"BAD_CODE";return Rt.recurciveEmailVerification(e,t,!0,i)}},async login(e,t,a,i=!1,o,s=!1){try{const n=await yt.getCaptchaSettings();if(n.visible.login&&!a?.recaptchaToken&&!o?.otp&&!o?.verificationId)throw D.pH;P.trackEvent((0,D.SU)(D.WW.ACTIONS.LOGIN.SUBMIT));const r=w?.getCurrentLightboxId(),c=v.getCurrentRouteInfo()?.pageId,l=s||at&&r&&at===r||at&&c&&at===c,d=n.invisible.login&&l?await Dt(D.MA.LOGIN):void 0,g=[];a?.recaptchaToken&&g.push({Recaptcha:a?.recaptchaToken}),d&&g.push({InvisibleRecaptcha:d});const m={loginId:{email:e},password:t,captchaTokens:g},p=await bt.request(function(e){var t=(0,G.d)(de,{}),a=t.toJSON,i=t.fromJSON,o=(0,G.d)(he,{_commonCustomValue:ae,_commonListValue:ie,_commonMapValue:oe,_customField:se,_customValue:ne,_identity:re,_identityProfile:ce,_listValue:le,_mapValue:ge}).fromJSON;function s(t){var i=t.host,s=a(e);return{entityFqdn:"wix.iam.authentication.v1.authentication",method:"POST",methodFqn:"wix.iam.authentication.v1.AuthenticationService.LoginV2",url:Se({protoPath:"/v2/login",data:s,host:i}),data:s,transformResponse:o}}return s.fromReq=i,s.__isAmbassador=!0,s}(m),{signedInstance:Z()}).then((e=>e.data)).catch((e=>{throw e.response?.data??e})),h=await Rt.getStateMachine(p,e),S=h?.additionalData?.protectedPages,b=(0,R.FB)(S),E=(0,R.$e)(h);if((0,R._y)(u,Ve,{sessionToken:h?.sessionToken})&&A["specs.thunderbolt.useNewPostLoginRedirect"])return(0,R.yw)();const C=await Rt.applySessionToken(h?.sessionToken,E,i&&!b),f=b??C,y=h?.sessionToken;return{sessionToken:y,member:E,...i?{pages:f}:{}}}catch(t){throw(0,R.qi)(t)||P.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Failure",eventLabel:"Wix"}}),t?.details?.applicationError?.code===D.OQ.WAITING_APPROVAL&&Rt.showAdminApprovalDialog(e),t?.response?.data??t}}};return i.export({promptLogin:Rt.promptLogin,logout:Rt.logout,memberDetails:nt}),a.update((e=>({...e,shouldShowRenderingBlockingDialogs:e=>e.relativeUrl!==D.m5&&!(!Rt.getForgotPasswordToken()&&!Rt.shouldDisplayWelcomeDialog()),showRenderingBlockingDialogs:()=>{const e=Rt.getForgotPasswordToken();return e?ye?Rt.navigateToResetPasswordPage(e):Rt.showResetPasswordDialog(e):Rt.shouldDisplayWelcomeDialog()?Rt.showWelcomeDialog():void 0}}))),Rt}));var Ve=a(16537),Be=a(60950),Fe=a(17840);const qe=(0,i.Og)([v.Np],(e=>({getTpaHandlers(){const t=async(t,a,i)=>{const o=await e.getMemberDetails(!0);return o?i.appClientSpecMapData?.isWixTPA?{attributes:{firstName:o.firstName??"",lastName:o.lastName??"",privacyStatus:o.profilePrivacyStatus},name:o.memberName,email:o.loginEmail,id:o.id,owner:o.owner,status:o.status}:{id:o.id,owner:o.owner,status:o.status}:null},a=async(t,a={})=>{const{member:i}=await e.promptLogin({mode:a.mode,modal:a.modal});return{attributes:{firstName:i.firstName??"",lastName:i.lastName??"",privacyStatus:i.profilePrivacyStatus},name:i.memberName,email:i.loginEmail,id:i.id,owner:i.owner,status:i.status}};return{currentMember:t,smCurrentMember:t,logOutCurrentMember:(0,Fe.V)(["site"],((t,a)=>{e.logout(a?.url)})),requestLogin:(0,Fe.V)(["site"],a),smRequestLogin:(0,Fe.V)(["site"],a)}}}))),We=(0,i.Og)([v.Np,(0,i.KT)(o.Gp,v.UU),r.Ji],((e,{componentIds:t},a)=>({name:"site-members-components",pageWillMount(){const i=t.reduce(((t,a)=>({...t,[a]:e.getSocialAuthComponentProps()})),{});a.update(i)}}))),$e=(0,i.Og)([(0,i.KT)(o.wk,v.UU)],(e=>({handle:async t=>{const{shouldShowRenderingBlockingDialogs:a,showRenderingBlockingDialogs:i}=e.get();return a(t)?(i(),null):t}}))),xe=e=>{e(v.Np,Ve.$.AppWillMountHandler,Ve.$.AppDidMountHandler).to(Me),e(b.po.BlockingDialogs).to($e)},He=e=>{e(Be.dQ).to(qe),e(Ve.$.PageWillMountHandler).to(We),e(Ve.$.PageWillUnmountHandler).to((0,i.Og)([v.Np],(e=>({pageWillUnmount:t=>e.pageWillUnmount(t)}))))}}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/group_9.8dd8a9b2.chunk.min.js.map