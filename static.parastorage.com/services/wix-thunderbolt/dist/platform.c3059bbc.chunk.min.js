"use strict";(self.webpackJsonp__wix_thunderbolt_app=self.webpackJsonp__wix_thunderbolt_app||[]).push([[569,2646,3169,5445],{33615:(e,t,a)=>{a.r(t),a.d(t,{ProtectedPagesApiSymbol:()=>y,page:()=>N,site:()=>k});var s,r=a(77748),o=a(20590),n=a(54563);!function(e){e.SM="SM",e.Pass="PASS",e.NONE="NONE"}(s||(s={}));const i=(0,r.Og)([(0,r.KT)(o._K,n.U),(0,r.KT)(o.YG,n.U),(0,r.KT)(o.wk,n.U)],((e,t,a)=>{const r=a=>{const r=e.pagesSecurity[a];return r&&r.requireLogin?s.SM:t.passwordProtected[a]||r&&r.passwordDigest?s.Pass:s.NONE};return{async handle(t){if(t.pageJsonFileName)return t;const o=t.pageId,{pagesMap:n,loginAndNavigate:i,authenticateUsingSitePassword:p,completedSitePasswordAuth:c}=a.get();if(n[o])return{...t,pageJsonFileName:n[o]};if(r("masterPage")===s.Pass&&!c)return p(t),null;const g=r(o);return g===s.NONE&&((e,t)=>{throw new Error(`we do not have authentication info for protected page ${e} page security: ${t}`)})(o,e.pagesSecurity[o]),i(t,g),null}}}));var p=a(71085),c=a(66397),g=a(19889),d=a(91994),l=a(12457),u=a(75396),P=a(32166),m=a(10553);const f=(0,r.Og)([(0,r.KT)(o.wk,n.U),(0,r.KT)(o.YG,n.U),(0,r.KT)(o._K,n.U),p.Ix,u.t7,(0,r.lq)(g.Np),(0,r.lq)(d.De),l.Tf,P.Ht,m.n],((e,{publicPageIds:t,pageUriSeoToRouterPrefix:a},{customNoPermissionsPageUriSeo:r,customNoPermissionsPageId:o},n,i,p,g,d,l,u)=>{const P=async(e,t)=>e===s.SM?(async()=>{let e;if(p)if(u["specs.thunderbolt.newAuthorizedPagesFlow"]){if(e=await p.requestAuthorizedPages(),e.success)return{authorizedPagesMap:e.pages,onProtectedPageNavigationComplete:async()=>{window.document.title=await d.getPageTitle()}}}else if(e=await p.requestAuthentication({}),e.success)return{authorizedPagesMap:await p.authorizeMemberPagesByToken(e.token)};return{authorizedPagesMap:{},authenticationResult:e}})():(async e=>g?g.promptPagePasswordDialog(e):{authorizedPagesMap:{}})(t),m=async(e,t,s=!1)=>{if(r&&s){const t=`${a[r]?`./${a[r]}/`:"./"}${r}`,s=encodeURIComponent(JSON.stringify({restrictedPageId:e.pageId,restrictedPagePath:(e.relativeEncodedUrl??"").replace("./","/")}));return n.navigate(`${t}?appSectionParams=${s}`)}if(p&&"SM"===t){const e=()=>{i.isLandingOnProtectedPage()&&n.navigate("./")};return p.showNoPermissionsToPageDialog(e),!1}return!!i.isLandingOnProtectedPage()&&n.navigate("./")};async function f(t){if(!g)return;const{authorizedPagesMap:a,onComplete:s}=await g.promptSitePasswordDialog();e.update((e=>({...e,pagesMap:Object.assign(e.pagesMap,a),completedSitePasswordAuth:!0}))),await n.navigate(t.parsedUrl.href),s?.()}const w=async(a,s)=>{const r=a.pageId;try{const{authorizedPagesMap:p,authenticationResult:g,onProtectedPageNavigationComplete:d}=await P(s,r);if(e.update((e=>({...e,pagesMap:Object.assign(e.pagesMap,p)}))),g?.reason===c.qd.CANCELED)return!!i.isLandingOnProtectedPage()&&n.navigate("./");if(p[r]){const e=await n.navigate(a.parsedUrl.href);return d?.(),e}{const r=t.includes(o),n=Boolean(e.get().pagesMap[o]);return m(a,s,r||n)}}catch(e){return l.captureError(e,{tags:{feature:"protectedPage"}}),m(a,s)}};return e.update((()=>({loginAndNavigate:w,authenticateUsingSitePassword:f,completedSitePasswordAuth:!1,pagesMap:{}}))),{appWillMount:async()=>{}}}));var w=a(16537),h=a(60950);const M=(0,r.Og)([(0,r.KT)(o.wk,n.U),g.Np],((e,t)=>({getTpaHandlers:()=>({authorizeMemberPages:async()=>{const a=await t.authorizeMemberPagesByCookie();e.update((e=>({...e,pagesMap:{...e.pagesMap,...a}})))}})})));const S=(0,r.Og)([(0,r.KT)(o.wk,n.U)],(function(e){return{getPageJsonFileName:t=>e.get()?.pagesMap[t]??null,getProtectedPages:()=>({...e.get()?.pagesMap??{}})}})),y=Symbol("ProtectedPagesApiSymbol"),k=e=>{e(p.po.Protected).to(i),e(w.$.AppWillMountHandler).to(f),e(y).to(S)},N=e=>{e(h.dQ).to(M)}},11682:(e,t,a)=>{a.r(t),a.d(t,{platformWorkerPromise:()=>c});const{viewerModel:{siteAssets:{clientTopology:s},siteFeatures:r,siteFeaturesConfigs:{platform:o},site:{externalBaseUrl:n}},usedPlatformApis:i}=window,p=Worker&&r.includes("platform"),c=p?(async()=>{const e="platform_create-worker started";performance.mark(e);const{clientWorkerUrl:t,appsScripts:a,bootstrapData:r,sdksStaticPaths:p}=o,{appsSpecData:c,appDefIdToIsMigratedToGetPlatformApi:g,forceEmptySdks:d}=r,l=t.startsWith("http://localhost:")||t.startsWith("https://bo.wix.com/suricate/")||document.baseURI!==location.href?(e=>{const t=new Blob([`importScripts('${e}');`],{type:"application/javascript"});return URL.createObjectURL(t)})(t):t.replace(s.fileRepoUrl,`${n}/_partials`),u=new Worker(l),P=Object.keys(a.urls).filter((e=>!c[e]?.isModuleFederated)).reduce(((e,t)=>(e[t]=a.urls[t],e)),{});if(p&&p.mainSdks&&p.nonMainSdks){Object.values(g).every((e=>e))||d?u.postMessage({type:"preloadNamespaces",namespaces:i}):u.postMessage({type:"preloadAllNamespaces",sdksStaticPaths:p})}u.postMessage({type:"platformScriptsToPreload",appScriptsUrls:P});const m="platform_create-worker ended";return performance.mark(m),performance.measure("Create Platform Web Worker",e,m),u})():Promise.resolve()}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/platform.c3059bbc.chunk.min.js.map