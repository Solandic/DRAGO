"use strict";(self.webpackJsonp__wix_thunderbolt_app=self.webpackJsonp__wix_thunderbolt_app||[]).push([[569,5445],{33615:(e,t,a)=>{a.r(t),a.d(t,{ProtectedPagesApiSymbol:()=>S,page:()=>U,site:()=>y});var s,o=a(77748),n=a(20590),r=a(54563);!function(e){e.SM="SM",e.Pass="PASS",e.NONE="NONE"}(s||(s={}));const i=(0,o.Og)([(0,o.KT)(n._K,r.U),(0,o.KT)(n.YG,r.U),(0,o.KT)(n.wk,r.U)],((e,t,a)=>{const o=a=>{const o=e.pagesSecurity[a];return o&&o.requireLogin?s.SM:t.passwordProtected[a]||o&&o.passwordDigest?s.Pass:s.NONE};return{async handle(t){if(t.pageJsonFileName)return t;const n=t.pageId,{pagesMap:r,loginAndNavigate:i,authenticateUsingSitePassword:g,completedSitePasswordAuth:p}=a.get();if(r[n])return{...t,pageJsonFileName:r[n]};if(o("masterPage")===s.Pass&&!p)return g(t),null;const c=o(n);return c===s.NONE&&((e,t)=>{throw new Error(`we do not have authentication info for protected page ${e} page security: ${t}`)})(n,e.pagesSecurity[n]),i(t,c),null}}}));var g=a(71085),p=a(66397),c=a(19889),u=a(91994),d=a(12457),P=a(75396),l=a(32166),w=a(10553);const h=(0,o.Og)([(0,o.KT)(n.wk,r.U),(0,o.KT)(n.YG,r.U),(0,o.KT)(n._K,r.U),g.Ix,P.t7,(0,o.lq)(c.Np),(0,o.lq)(u.De),d.Tf,l.Ht,w.n],((e,{publicPageIds:t,pageUriSeoToRouterPrefix:a},{customNoPermissionsPageUriSeo:o,customNoPermissionsPageId:n},r,i,g,c,u,d,P)=>{const l=async(e,t)=>e===s.SM?(async()=>{let e;if(g)if(P["specs.thunderbolt.newAuthorizedPagesFlow"]){if(e=await g.requestAuthorizedPages(),e.success)return{authorizedPagesMap:e.pages,onProtectedPageNavigationComplete:async()=>{window.document.title=await u.getPageTitle()}}}else if(e=await g.requestAuthentication({}),e.success)return{authorizedPagesMap:await g.authorizeMemberPagesByToken(e.token)};return{authorizedPagesMap:{},authenticationResult:e}})():(async e=>c?c.promptPagePasswordDialog(e):{authorizedPagesMap:{}})(t),w=async(e,t,s=!1)=>{if(o&&s){const t=`${a[o]?`./${a[o]}/`:"./"}${o}`,s=encodeURIComponent(JSON.stringify({restrictedPageId:e.pageId,restrictedPagePath:(e.relativeEncodedUrl??"").replace("./","/")}));return r.navigate(`${t}?appSectionParams=${s}`)}if(g&&"SM"===t){const e=()=>{i.isLandingOnProtectedPage()&&r.navigate("./")};return g.showNoPermissionsToPageDialog(e),!1}return!!i.isLandingOnProtectedPage()&&r.navigate("./")};async function h(t){if(!c)return;const{authorizedPagesMap:a,onComplete:s}=await c.promptSitePasswordDialog();e.update((e=>({...e,pagesMap:Object.assign(e.pagesMap,a),completedSitePasswordAuth:!0}))),await r.navigate(t.parsedUrl.href),s?.()}const M=async(a,s)=>{const o=a.pageId;try{const{authorizedPagesMap:g,authenticationResult:c,onProtectedPageNavigationComplete:u}=await l(s,o);if(e.update((e=>({...e,pagesMap:Object.assign(e.pagesMap,g)}))),c?.reason===p.qd.CANCELED)return!!i.isLandingOnProtectedPage()&&r.navigate("./");if(g[o]){const e=await r.navigate(a.parsedUrl.href);return u?.(),e}{const o=t.includes(n),r=Boolean(e.get().pagesMap[n]);return w(a,s,o||r)}}catch(e){return d.captureError(e,{tags:{feature:"protectedPage"}}),w(a,s)}};return e.update((()=>({loginAndNavigate:M,authenticateUsingSitePassword:h,completedSitePasswordAuth:!1,pagesMap:{}}))),{appWillMount:async()=>{}}}));var M=a(16537),m=a(60950);const f=(0,o.Og)([(0,o.KT)(n.wk,r.U),c.Np],((e,t)=>({getTpaHandlers:()=>({authorizeMemberPages:async()=>{const a=await t.authorizeMemberPagesByCookie();e.update((e=>({...e,pagesMap:{...e.pagesMap,...a}})))}})})));const N=(0,o.Og)([(0,o.KT)(n.wk,r.U)],(function(e){return{getPageJsonFileName:t=>e.get()?.pagesMap[t]??null,getProtectedPages:()=>({...e.get()?.pagesMap??{}})}})),S=Symbol("ProtectedPagesApiSymbol"),y=e=>{e(g.po.Protected).to(i),e(M.$.AppWillMountHandler).to(h),e(S).to(N)},U=e=>{e(m.dQ).to(f)}}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/assetsLoader.14dc79b8.chunk.min.js.map