!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("lodash")):"function"==typeof define&&define.amd?define("blocks-client-viewer-app",["lodash"],t):"object"==typeof exports?exports["blocks-client-viewer-app"]=t(require("lodash")):e["blocks-client-viewer-app"]=t(e.lodash)}("undefined"!=typeof self?self:this,(e=>(()=>{var t,r,n={205:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(394),t)},394:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleList=void 0,t.ModuleList=["wix-ecom-backend","wix-echo-backend","wix-blog-backend","wix-loyalty-backend","wix-portfolio-backend","wix-pro-gallery-backend","wix-bookings.v2","wix-inbox.v2","wix-email-marketing.v2","wix-forum.v2","wix-loyalty.v2","wix-activity-counters.v2","wix-business-tools.v2","wix-stores.v2","wix-marketing-tags.v2","wix-sender-details.v2","wix-media.v2","wix-pricing-plans.v2","wix-members.v2","wix-groups.v2","wix-marketing.v2","wix-data-backup-service-v2","wix-restaurants-backend","wix-currencies.v2","wix-authentication-management.v2","wix-auth-management.v2","wix-redirects.v1","wix-ecom.v2","wix-data.v2","wix-crm.v2","wix-notifications.v2","wix-workflows.v2","wix-captcha.v2","wix-table-reservations.v2","wix-categories.v2","wix-reviews.v2","wix-notifications.v3","wix-comments.v2","wix-rise.v2","wix-bookings.v1","wix-search.v2","wix-members-about.v1","wix-forms.v2","wix-restaurants.v2","wix-ads-txt.v1","wix-members.v3","wix-custom-fields-schema.v2","wix-export-async-job.v1","wix-settings.v2","wix-multilingual.v2","wix-app-settings.v2","wix-calendar.v3","wix-billing.v2","wix-stores.v3","wix-payments.v2","wix-ep-plugins.v1","wix-events.v2","wix-urls.v2","wix-app-plugins-site-plugins.v1","wix-search.v3","wix-app-management.v2","wix-site-plugins.v1","wix-dashboard-management.v2","wix-editor-deployments.v1","wix-tags.v1","wix-packages.v1","wix-domains.v1","wix-moderation-rules.v1","wix-automations.v2","wix-referral.v1","wix-custom-fields.v1","wix-members.v1","wix-subscription.v1","wix-review-request.v1","wix-site-actions.v2","wix-members-area.v1","wix-analytics-session.v1","wix-analytics-data.v2","wix-apps-installer.v1","wix-async-jobs.v2","migration-triggers.v1","trigger-catalog.v1","wix-automations.v1","wix-assistant-widget.v1","wix-editor-site-embeds.v1","wix-automations-actioncatalog.v1","wix-automations-activation-log.v1","wix-assistant-playground.v1","wix-instagram-media.v1","wix-automations-activation-action-log.v1","wix-analytics-session.v2","wix-automations-activation-summary.v1","wix-functions.v1","wix-automations-runner.v1","wix-data-extension-schema.v1","wix-assistant-playground.v2","wix-gift-vouchers.v2","wix-reports.v2","wix-review-requests.v2","wix-promote-growth-tools-design.v1","wix-premium-product-type.v1"]},676:(e,t,r)=>{"use strict";t.C9=t.et=void 0;var n=r(587);var o=r(298);Object.defineProperty(t,"et",{enumerable:!0,get:function(){return o.generateBackendPackageWebMethodUrl}}),Object.defineProperty(t,"C9",{enumerable:!0,get:function(){return o.getBackendPackageNameFromImportName}})},360:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConvertersComposer=void 0;var n=r(289),o=function(e){return null!==e&&"object"==typeof e},i=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._converters=e}return e.prototype.convertToCustomFormat=function(e,t,r){var n;if(void 0===t&&(t=new Set),void 0===r&&(r=!1),o(e)){if(t.has(e))throw new TypeError("Converting circular structure to JSON");t.add(e)}if(Array.isArray(e))return this._convertArray(e,t);var i=null===(n=this._findConverterToCustomFormat(e))||void 0===n?void 0:n.convertToCustomFormat(e,r);return o(e)?this._convertObject(i,e,t):i},e.prototype.convertFromCustomFormat=function(e){var t,r=this,i=e;return Array.isArray(e)?i=e.map((function(e){return r.convertFromCustomFormat(e)})):o(e)&&(i=(0,n.mapValues)(e,this.convertFromCustomFormat.bind(this))),null===(t=this._findConverterFromCustomFormat(i))||void 0===t?void 0:t.convertFromCustomFormat(i)},e.prototype._convertObject=function(e,t,r){var o,i=this;return o="function"==typeof e.toJSON?(0,n.mapValues)(e.toJSON(),(function(e){return i.convertToCustomFormat(e,r)})):(0,n.mapValues)(e,(function(e){return i.convertToCustomFormat(e,r)})),r.delete(t),o},e.prototype._convertArray=function(e,t){var r=this,n=e.map((function(e){return r.convertToCustomFormat(e,t,!0)}));return t.delete(e),n},e.prototype._findConverterFromCustomFormat=function(e){return this._converters.find((function(t){return t.canConvertFromCustomFormat(e)}))},e.prototype._findConverterToCustomFormat=function(e){return this._converters.find((function(t){return t.canConvertToCustomFormat(e)}))},e}();t.ConvertersComposer=i},815:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DateConverter=void 0;var r=function(){function e(){}return e.prototype.canConvertToCustomFormat=function(e){return e instanceof Date},e.prototype.convertToCustomFormat=function(e){return{$date:e.toISOString()}},e.prototype.canConvertFromCustomFormat=function(e){return this._isObjectWith$Date(e)&&"string"==typeof e.$date&&(t=e.$date,!Number.isNaN(Date.parse(t)));var t},e.prototype.convertFromCustomFormat=function(e){return new Date(e.$date)},e.prototype._isObjectWith$Date=function(e){return!!e&&"object"==typeof e&&"$date"in e},e}();t.DateConverter=r},500:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultConverter=void 0;var r=function(){function e(){}return e.prototype.canConvertToCustomFormat=function(){return!0},e.prototype.convertToCustomFormat=function(e,t){return t&&void 0===e?null:e},e.prototype.canConvertFromCustomFormat=function(){return!0},e.prototype.convertFromCustomFormat=function(e){return e},e}();t.DefaultConverter=r},587:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertFromCustomFormat=t.convertToCustomFormat=void 0;var n=r(360),o=r(815),i=r(500),a=new n.ConvertersComposer(new o.DateConverter,new i.DefaultConverter);t.convertToCustomFormat=function(e){return a.convertToCustomFormat(e)};t.convertFromCustomFormat=function(e){return a.convertFromCustomFormat(e)}},289:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapValues=void 0,t.mapValues=function(e,t){var r={};return Object.keys(e).forEach((function(n){var o=t(e[n]);void 0!==o&&(r[n]=o)})),r}},298:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBackendPackageNameFromImportName=t.generateBackendPackageWebMethodUrl=t.generatePackageWebMethodUrl=t.exceptionToWebMethodPayload=t.resultToWebMethodPayload=void 0;var n=r(587);t.resultToWebMethodPayload=function(e,t){var r=t?JSON.parse(JSON.stringify(e,t)):(0,n.convertToCustomFormat)(e);return void 0===r?{}:{result:r}};t.exceptionToWebMethodPayload=function(e,t,r){return void 0===t&&(t=function(e){return e}),void 0===r&&(r=function(e){return""}),{result:e instanceof Error?{message:t(e.message),name:e.name,stack:r(e.stack),code:e.code,_elementoryError:!0}:e,exception:!0}};var o=function(e,t){return"/_webMethods/packages/".concat(encodeURIComponent(e),"/").concat(t,".ajax")};t.generatePackageWebMethodUrl=o;t.generateBackendPackageWebMethodUrl=function(e,t){return o("".concat(e,"-backend"),t)};t.getBackendPackageNameFromImportName=function(e){return"".concat(e,"-backend")}},371:(e,t)=>{"use strict";t.Z=void 0;t.Z=()=>"cachebuster2"},332:function(e){"undefined"!=typeof self&&self,e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";var n={"wix-users":"user","wix-events":"wixEvents"};e.exports.namespaceToSdk=function(e){return n[e]||e.replace("wix-","").replace(/-frontend$/,"")},e.exports.sdkToNamespace=function(e){return Object.keys(n).find((function(t){return n[t]===e}))||"wix-".concat(e)}},function(e,t,r){"use strict";var n=r(2).buildNamespacesMap,o=r(0).namespaceToSdk;e.exports={buildNamespacesMap:n,namespaceToSdk:o}},function(e,t,r){"use strict";var n=r(3).createWixFetch,o=r(0).sdkToNamespace;e.exports={buildNamespacesMap:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e};return Object.keys(e).reduce((function(t,n){var i=e[n];if("events"===n);else{var a=o(n);t[a]=r(i),t["".concat(a,"-frontend")]=r(i)}return t}),{"wix-fetch":r(n(t))})}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.exports={createWixFetch:function(e){return{fetch:e,getJSON:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i(i({},r),{},{method:"GET",headers:i({Accept:"application/json"},r.headers)});return e(t,n).then((function(e){return e.json()}))}}}}}])},932:e=>{"use strict";class t extends Error{constructor(e){super(t._prepareSuperMessage(e)),Object.defineProperty(this,"name",{value:"NonError",configurable:!0,writable:!0}),Error.captureStackTrace&&Error.captureStackTrace(this,t)}static _prepareSuperMessage(e){try{return JSON.stringify(e)}catch{return String(e)}}}const r=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0}],n=Symbol(".toJSON called"),o=({from:e,seen:t,to_:i,forceEnumerable:a,maxDepth:s,depth:c})=>{const d=i||(Array.isArray(e)?[]:{});if(t.push(e),c>=s)return d;if("function"==typeof e.toJSON&&!0!==e[n])return(e=>{e[n]=!0;const t=e.toJSON();return delete e[n],t})(e);for(const[r,n]of Object.entries(e))"function"==typeof Buffer&&Buffer.isBuffer(n)?d[r]="[object Buffer]":"function"!=typeof n&&(n&&"object"==typeof n?t.includes(e[r])?d[r]="[Circular]":(c++,d[r]=o({from:e[r],seen:t.slice(),forceEnumerable:a,maxDepth:s,depth:c})):d[r]=n);for(const{property:t,enumerable:n}of r)"string"==typeof e[t]&&Object.defineProperty(d,t,{value:e[t],enumerable:!!a||n,configurable:!0,writable:!0});return d};e.exports={serializeError:(e,t={})=>{const{maxDepth:r=Number.POSITIVE_INFINITY}=t;return"object"==typeof e&&null!==e?o({from:e,seen:[],forceEnumerable:!0,maxDepth:r,depth:0}):"function"==typeof e?`[Function: ${e.name||"anonymous"}]`:e},deserializeError:(e,r={})=>{const{maxDepth:n=Number.POSITIVE_INFINITY}=r;if(e instanceof Error)return e;if("object"==typeof e&&null!==e&&!Array.isArray(e)){const t=new Error;return o({from:e,seen:[],to_:t,maxDepth:n,depth:0}),t}return new t(e)}}},773:t=>{"use strict";t.exports=e}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={exports:{}};return n[e].call(r.exports,r,r.exports,i),r.exports}i.m=n,i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,r)=>(i.f[r](e,t),t)),[])),i.u=e=>e+".chunk.min.js",i.miniCssF=e=>{},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},r="_wix_blocks_client_viewer_app:",i.l=(e,n,o,a)=>{if(t[e])t[e].push(n);else{var s,c;if(void 0!==o)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var p=d[u];if(p.getAttribute("src")==e||p.getAttribute("data-webpack")==r+o){s=p;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",r+o),s.src=e,0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous")),t[e]=[n];var l=(r,n)=>{s.onerror=s.onload=null,clearTimeout(f);var o=t[e];if(delete t[e],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((e=>e(n))),r)return r(n)},f=setTimeout(l.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=l.bind(null,s.onerror),s.onload=l.bind(null,s.onload),c&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="https://static.parastorage.com/services/blocks-client-viewer-app/a559fa67119ab32b28898a1fb681b4176b2b89f3e907408fdaa42aec/",(()=>{var e={398:0};i.f.j=(t,r)=>{var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise(((r,o)=>n=e[t]=[r,o]));r.push(n[2]=o);var a=i.p+i.u(t),s=new Error;i.l(a,(r=>{if(i.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,n[1](s)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,o,[a,s,c]=r,d=0;if(a.some((t=>0!==e[t]))){for(n in s)i.o(s,n)&&(i.m[n]=s[n]);if(c)c(i)}for(t&&t(r);d<a.length;d++)o=a[d],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=("undefined"!=typeof self?self:this).webpackJsonp__wix_blocks_client_viewer_app=("undefined"!=typeof self?self:this).webpackJsonp__wix_blocks_client_viewer_app||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var a={};return(()=>{"use strict";i.r(a),i.d(a,{createControllers:()=>xt,initAppForPage:()=>bt});class e{static getCommonTags(e){const{metaSiteId:t,isServerSide:r,isPreview:n,viewerName:o,viewMode:i,pageUrl:a,pageId:s}=e.bi;return{metaSiteId:t,isSSR:r,isEditor:n,viewer:o,viewMode:i,pageUrl:a,pageId:s}}init({essentials:e,fedOpsLoggerFactory:t},{appDefId:r,errorMonitorOptions:n,fedOps:o}){var i;this.monitor=e.createErrorMonitor(n),this.fedOpsLogger=(i=r,t.getLoggerForWidget({appId:i,appName:i,phasesConfig:"SEND_START_AND_FINISH"})),this.interactionPrefix=o?.interactionPrefix??""}reportError(e,t){console.error(e,t);const r=function(e){const t={};try{e.originalError&&(t[e.originalError.name]={originalError:e.originalError}),e.url&&(t.url={url:e.url})}catch(e){console.error("failed retrieving extra context")}return t}(t);this.monitor.captureException(t,{contexts:r,tags:{groupingTag:e}})}wrapWithErrorReporter(e,t){const r=this;return function(...n){try{return e(...n)}catch(e){throw r.reportError(t,e),e}}}interactionStarted(e){this.fedOpsLogger.interactionStarted(`${this.interactionPrefix}${e}`)}interactionEnded(e){this.fedOpsLogger.interactionEnded(`${this.interactionPrefix}${e}`)}appPhaseStarted(e,t){this.fedOpsLogger.appLoadingPhaseStart(`${this.interactionPrefix}${e}`,t)}appPhaseEnded(e,t){this.fedOpsLogger.appLoadingPhaseFinish(`${this.interactionPrefix}${e}`,t)}appLoadStarted(){this.fedOpsLogger.appLoadStarted()}appLoadEnded(){this.fedOpsLogger.appLoaded()}}const t=new class{constructor(){this.initialized=!1}calcOverriddenExperiments(e){try{const t=new URL(e.location.url).searchParams.get("experiments");return t?.split(",").reduce(((e,t)=>({...e,[t]:"true"})),{})??{}}catch(e){}return{}}async init({scope:e,wixCodeApi:t,platformServicesAPI:r,logger:n,preloadedExperiments:o}){if(this.experiments=r.essentials.createExperiments({useNewApi:!0}),o)this.experiments.add(o);else try{await this.experiments.load(e)}catch(e){n.reportError("Failed loading experiments",e)}this.experiments.add(this.calcOverriddenExperiments(t)),this.initialized=!0}isOpen(e){if(!this.initialized||!this.experiments)throw new Error("Experiments not initialized");return this.experiments.enabled(e)}reset(){this.initialized=!1,this.experiments=void 0}},r={APP_DEF_ID:"46b2ad43-5720-41d2-8436-2058979cb53f",SENTRY:{DSN:"https://69fbdb10071647948ccff7dce7d7ccc6@sentry-next.wixpress.com/530"},LOGGER:{PREFIX:"blocks-client-viewer-app_"},INTERACTIONS:{CREATE_CONTROLLERS:"create-controllers"},PHASES:{LOAD_WIDGET:"load-widget"},EXPERIMENTS_SCOPE:"blocks-client"};function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}const o=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(r,"message",{configurable:!0,enumerable:!1,value:e,writable:!0}),Object.defineProperty(r,"name",{configurable:!0,enumerable:!1,value:r.constructor.name,writable:!0}),Error.hasOwnProperty("captureStackTrace")?(Error.captureStackTrace(r,r.constructor),n(r)):(Object.defineProperty(r,"stack",{configurable:!0,enumerable:!1,value:new Error(e).stack,writable:!0}),r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(function(e){function t(){e.apply(this,arguments)}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}(Error));class s extends o{constructor(){super("Not a blocks app - Missing blocksData in app params"),this.name="NotBlocksAppError"}}var c=i(773);const d=e=>(0,c.upperFirst)((0,c.camelCase)(e)),u=/.*\?(.*?)}?$/,p=e=>{const t=(e=>{const[,t]=u.exec(e)||[];return t||""})(e.siteAssets),r=new URLSearchParams(t);return{siteId:r.get("siteId"),metaSiteId:r.get("metaSiteId"),revision:r.get("siteRevision")}},l=e=>Boolean(e.baseUrls.siteAssets)&&"blocksData"in e,f=e=>Boolean(e.appData&&"blocksPreviewData"in e.appData);function m(e){if(!l(e))throw new s;const{wixCodeInstanceId:t,wixCodeGridId:r}=e.blocksData,{siteId:n,metaSiteId:o,revision:i}=p(e.baseUrls);return{appDefinitionId:e.appDefinitionId,code:{instanceId:t,gridId:r,experimentsQueryString:e.appData?.blocksConsumerData?.codeExperimentsQueryString||""},siteId:n,metaSiteId:o,revision:i,codePackagesData:e.appData?.blocksConsumerData?.codePackagesData}}function w(e){return Boolean(e)&&e instanceof Error}class h extends o{constructor(e,t,r){super(t),this.originalError=r,this.name=e,w(r)&&(this.stack=r.stack)}}class g extends h{constructor(e,t){super("FetchDescriptorError","Failed fetching widget descriptor",t),this.url=e}}var v=i(371);const y=(e,{code:t,metaSiteId:r})=>{const{instanceId:n,gridId:o,experimentsQueryString:i}=t,a=new URL(`https://bundler.wix-code.com/${r}/${n}/${o}/pages/${e}.js`),s=new URLSearchParams(i);return s.append("cache-buster",(0,v.Z)()),a.search=s.toString(),a.toString()},b="AbortError",x=e=>e?.name===b;class _ extends h{constructor(e,t,r){super(b,"Fetch aborted",r),this.url=e,this.requestId=t}}const P="CustomTypeError";class E extends h{constructor(e,t,r){super(P,"Load failed",r),this.url=e,this.requestId=t}}const S="FetchError",O=e=>e?.name===S;class C extends o{constructor(e,t){super("Fetch failed"),this.url=e,this.statusCode=t,this.name=S}}const k=async(e,t=0)=>{let r;try{if(r=await fetch(e),r.ok)return r.json();throw new C(e,r.status)}catch(o){if(2===t){const t=r?.headers?.get("x-wix-request-id")??null;if(o instanceof TypeError)throw new E(e,t,o);if(x(o))throw new _(e,t,o);throw o}return await(n=2**t*10,new Promise((e=>setTimeout(e,n)))),k(e,t+1)}var n},I={},T="fetch-widget-descriptor";async function A(e,t,r){if(!e.config.devCenterWidgetId)return console.info("missing devCenterWidgetId",{type:e.config.type}),I;const n=`$blocks-warmup-descriptor_${e.config.devCenterWidgetId}`,o=e.wixCodeApi.window.warmupData.get(n);if(o)return o;const i=((e,{appDefinitionId:t,revision:r})=>`https://wixmp-6f01a4ce0453f15410e74e05.wixmp.com/widget-descriptors/${t}/${e}/${r}/widgetDescriptor.json`)(e.config.devCenterWidgetId,t);try{r?.interactionStarted(T);const t=await async function(e){try{return await k(e)}catch(t){if(O(t)&&403===t.statusCode)return console.info("missing widget descriptor",{descriptorUrl:e}),I;throw t}}(i);return e.wixCodeApi.window.warmupData.set(n,t),r?.interactionEnded(T),t}catch(e){if(x(e))throw r?.interactionEnded(T),e;if((e=>e?.name===P)(e))throw e;throw new g(i,e)}}class D{constructor(e,t,r){this._widgetControllersConfigs=t,this.options=r,this._widgetMetaDataStore={},this._blocksConfig=r?.blocksConfig??m(e),this.preLoadWidgetMetaData()}preLoadWidgetMetaData(){this._widgetControllersConfigs.forEach((e=>{const t=e.config.type;this._widgetMetaDataStore[t]||(this._widgetMetaDataStore[t]=A(e,this._blocksConfig,this.options?.logger))}))}getMetaData(e){return this._widgetMetaDataStore[e]}}const j=e=>JSON.parse(JSON.stringify(e));function M(e,t,r,n,o){const i={};function a(e,t,r,n=[]){r=r||Object.getOwnPropertyNames(t).filter((e=>!(0,c.isFunction)(t[e])));for(const t of r)s(e,t,n);return e}function s(e,r,s){Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get(){const e=s.concat(r);let n=(0,c.get)(t,e);var o;return o=n,(0,c.isObjectLike)(o)&&Object.getPrototypeOf(o)===Object.prototype&&(n=function(e,t){const r=t.join("/");if(i[r])return i[r];const n=a({},e,null,t);return i[r]=n,n}(n,e)),n},set(e){const a=s.concat(r),d=a.join("/"),u=j(t);(0,c.set)(t,a,e),delete i[d];n(u,t,o?{_internalApiDoNotUse:{propName:r,path:a}}:void 0)}})}a(e,t,r)}const N=e=>({type:"widgetEvent",data:e});class $ extends h{constructor(e){super("WidgetCreationError","Failed running create widget function",e),w(e)&&(this.originalMessage=e.message)}}function F(e={},t){if(!t)return e;return[...new Set([...Object.keys(e),...Object.keys(t)])].reduce(((r,n)=>{const o=e[n],i=t[n];return(0,c.isPlainObject)(o)?r[n]=F(o,i):r[n]=(0,c.isNil)(o)?i:o,r}),{})}const R=(e=[])=>e.reduce(((e,{name:t,defaultValue:r})=>(e[t]=r,e)),{});function W({appParams:e}){return!!l(e)&&e.appData?.blocksConsumerData?.invokePropsChangedOnUpdateConfig}async function L(e,t,r,n={shouldAddInternalApi:!0}){const{$w:o,config:i}=e,a=R(t.properties),s=F(i.props,a),{generate$widget:u,generateWidgetAPI:p,setProps:l}=function(e,t=!0){const r=function(){const e=[];return{register(t){e.push(t)},fire(t,r,n){e.forEach((e=>e(t,r,n)))}}}(),n=e;return{generate$widget:function(e){return{props:n,onPropsChanged(e){r.register(e)},fireEvent(t,r){e.fireEvent(t,N(r))}}},generateWidgetAPI:function(e,n){const o={...n};return M(o,e.props,Object.keys(e.props),((e,t,n)=>{r.fire(e,t,n)}),t),o},setProps:function(e,t){const n=e.props;e.props=t,r.fire(n,t)}}}(s,n.shouldAddInternalApi),f=u(o);let m,w,h=c.noop,g={};try{const t=await r({$widget:f,...e});h=t?.pageReady,g=t?.exports,m=t?.updateWidgetViewState,w=t?.getWidgetViewStateAfterRefresh}catch(e){throw new $(e)}const v=e=>function(e,t,r,n){return t.events?.forEach((({name:t})=>{e[`on${d(t)}`]=e=>r.on(t,(t=>e(n(t))))})),e}(p(f,g),t,o,function(e,t){return r=>{if(t)return t(r);const{type:n,...o}=r;return e.createEvent(n,o)}}(o,e));return{pageReady:e=>h(e),updateConfig:W(e)?(e,t)=>{const r=t.props?F(t.props,f.props):a;l(f,r)}:void 0,updateWidgetViewState:m,getWidgetViewStateAfterRefresh:w,exports:(e,t)=>v(t)}}var U=i(676);var J,q=i(332);!function(e){e[e.TO_JSON=0]="TO_JSON",e[e.FROM_JSON=1]="FROM_JSON"}(J||(J={}));const B=e=>e.split("#");const H="_",z=/{(.*)}/,G=new RegExp(`\\.(${["wix.com","editorx.com"].join("|")})$`),V=new RegExp(`\\.(${["42.wixprod.net","uw2-edt-1.wixprod.net"].join("|")})$`),Q=new RegExp(".*\\.dev.wix-code.com$");function X(e){const t=function(e,t){const r=t[e]||t[H];if(!r&&function(e){return!!e.match(/\._base_domain_$/)}(e))return t[Y];return r}(function(e){return e.replace("create.editorx.com","editor.editorx.com")}(e.host).replace(G,"._base_domain_").replace(V,"._api_base_domain_").replace(Q,"*.dev.wix-code.com"),e.domainToMappings);var r,n;return function(e,t){const r=null==t?void 0:t.find((t=>e.startsWith(t.destPath)));if(!r)return e;return r.srcPath+e.slice(r.destPath.length)}((r=e.protoPath,n=e.data||{},r.split("/").map((e=>function(e,t){const r=e.match(z)||[],n=r[1];if(n){const o=e.replace(r[0],"");return function(e,t,r,n){let o=e;for(const e of t.split(".")){if(!o)return r;o=o[e]}return`${o}${n}`}(t,n,e,o)}return e}(e,n))).join("/")),t)}const Y="www._base_domain_";function K(e,t=""){const r={};return Object.entries(e).forEach((([e,n])=>{const o=null!==n&&"object"==typeof n&&!Array.isArray(n),i=function(e,t){return`${e}${e?".":""}${t}`}(t,e);if(o){const e=K(n,i);Object.assign(r,e)}else r[i]=n})),r}function Z(e){const t=K(e);return Object.entries(t).reduce(((e,[t,r])=>((Array.isArray(r)?r:[r]).forEach((r=>{null!=r&&e.append(t,r)})),e)),new URLSearchParams)}function ee(e,t={},r){return function(n={},o){return"string"==typeof n?n:i(e,n);function i(e,t){const r={};return[null,void 0].includes(t)?t:(Object.entries(t).forEach((([t,n])=>{var o,i,c;const d=e[t],{schemaName:u,schemaType:p}=function(e=""){const[t,r]=B(e);return r?{schemaName:r,schemaType:t}:{schemaName:t}}(d),l="Map"===p;let f;f=(null!==(c=null===(i=null===(o=s(u))||void 0===o?void 0:o.checkRepetable)||void 0===i?void 0:i.call(o,n))&&void 0!==c?c:Array.isArray(n))?n.map((e=>a(e,u))):l?function(e,t){return Object.entries(e).reduce(((e,[r,n])=>(e[r]=a(n,t),e)),{})}(n,u):a(n,u),r[t]=f})),r)}function a(e,r){if(!r)return e;const n=t[r];if(s(r))return s(r).transform(e);if(n)return i(n,e);throw new Error(`${r} is neither schema nor serializable type`)}function s(e){var t;return null===(t=r[e])||void 0===t?void 0:t[o]}}}const te={types:["google.protobuf.Timestamp"],[J.TO_JSON]:{transform:e=>null==e?void 0:e.toISOString()},[J.FROM_JSON]:{transform:e=>e?new Date(e):void 0}},re={types:["google.protobuf.FieldMask"],[J.TO_JSON]:{transform:e=>e.join(","),checkRepetable:e=>e.some((e=>Array.isArray(e)))},[J.FROM_JSON]:{transform:e=>"object"==typeof e?e.paths:e.split(",")}},ne={types:["google.protobuf.BytesValue","BYTES"],[J.TO_JSON]:{transform:e=>{const t=e.reduce(((e,t)=>e+String.fromCharCode(t)),"");return btoa(t)}},[J.FROM_JSON]:{transform:e=>Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))}},oe={types:["google.protobuf.Duration"],[J.TO_JSON]:{transform:({seconds:e="0",nanos:t=0})=>{let r="";return 0!==t&&(r=`.${t.toString().padStart(9,"0")}`),`${e}${r}s`}},[J.FROM_JSON]:{transform:e=>{const[t,r]=e.substring(0,e.length-1).split(".");return{seconds:t,nanos:ie(r)}}}};function ie(e){let t=0;if(void 0!==e){const r=3-e.length/3;t=parseInt(e,10)*Math.pow(1e3,r)}return t}const ae={types:["FLOAT","DOUBLE","google.protobuf.FloatValue","google.protobuf.DoubleValue"],[J.TO_JSON]:{transform:e=>isFinite(e)?e:e.toString()},[J.FROM_JSON]:{transform:e=>"NaN"===e?NaN:"Infinity"===e?1/0:"-Infinity"===e?-1/0:e}};const se=[...[te,re,ne,oe,ae]].reduce(((e,t)=>{const r=t.types.reduce(((e,r)=>Object.assign(Object.assign({},e),{[r]:t})),{});return Object.assign(Object.assign({},e),r)}),{});function ce(e,t={}){const r=ee(e,t,se);return{fromJSON(e){const t=function(e){try{return JSON.parse(e)}catch(e){}}(e)||e;return r(t,J.FROM_JSON)},toJSON:e=>r(e,J.TO_JSON)}}var de={},ue={};function pe(e){var t=ce(de,{}),r=t.toJSON,n=t.fromJSON,o=ce(ue,{}).fromJSON;function i(t){var n,i=t.host,a=r(e);return{entityFqdn:"wix.devcenter.iv.v1.instance",method:"POST",methodFqn:"wix.devcenter.iv.v1.InstanceVerification.DecodeInstance",url:(n={protoPath:"/v1/decode-instance",data:a,host:i},X(Object.assign(n,{domainToMappings:{"manage._base_domain_":[{srcPath:"/_api/instance-verification",destPath:""}],_:[{srcPath:"/_api/instance-verification",destPath:""}],"*.dev.wix-code.com":[{srcPath:"/_api/instance-verification",destPath:""}],"www._base_domain_":[{srcPath:"/_api/instance-verification",destPath:""}],"editor._base_domain_":[{srcPath:"/_api/instance-verification",destPath:""}],"blocks._base_domain_":[{srcPath:"/_api/instance-verification",destPath:""}],"create.editorx":[{srcPath:"/_api/instance-verification",destPath:""}],"api._api_base_domain_":[{srcPath:"/instance-verification",destPath:""}]}}))),data:a,transformResponse:o}}return i.fromReq=n,i.__isAmbassador=!0,i}const le="NetworkError",fe="NS_BINDING_ABORTED",me="22bef345-3c5b-4c18-b782-74d4085112ff",we=e=>e.site.getSiteStructure({includePageId:!0}),he=(e,t,r)=>{const{storage:n}=t,o=(e=>{const{appParams:{instance:t,appDefinitionId:r},essentials:{httpClient:n},wixCodeApi:o}=e;return{getAppInstance:()=>(console.warn("getAppInstance is deprecated, please use getAccessToken instead"),t),getAccessToken:()=>t,getDecodedAppInstance:async()=>{if("preview-instance"===t)return Promise.resolve({appDefId:"00000000-0000-0000-0000-000000000000",instanceId:"00000000-0000-0000-0000-000000000000"});if(t.startsWith("OauthNG.")){const e=await n.post("/oauth2/token-info",{token:t},{baseURL:"https://www.wixapis.com"});return{appDefId:e.data.clientId,instanceId:e.data.instanceId,vendorProductId:e.data.vendorProductId}}const r="Site"===o.window.viewMode?new URL(o.location.baseUrl).origin:void 0,i=e.platformAPIs.essentials.env.platformEnv.getAppToken(me),{data:a}=await n.request((e=>({...pe({instance:t})(e),baseURL:r})),{signedInstance:i});return a.decodedInstance||null},getAppPageUrl:async e=>{const t=await we(o),n=(i=r,a=e,e=>e.applicationId===i&&e.tpaPageId===a);var i,a;const s=t.pages.find(n);return s?.url||null},openAppLightbox:async(e,t)=>{const n=await we(o),i=(a=r,s=e,e=>e.appDefinitionId===a&&e.tpaPageId===s);var a,s;const c=n.lightboxes.find(i);return c&&o.window.openLightboxById(c.id,t)}}})(r);return{storage:n,application:o,...e}};var ge=i(205),ve={},ye={};const be="$blocks-warmup-modules-to-load",xe=async(e,t)=>t.platformApiProvider.getPlatformApi(e),_e=(e,t)=>{const r=e.platformAPIs.essentials.env.platformEnv.getAppToken(me);return e.essentials.httpClient.request(function(e){var t=ce(ve,{}),r=t.toJSON,n=t.fromJSON,o=ce(ye,{}).fromJSON;function i(t){var n,i=t.host,a=r(e);return{entityFqdn:"wix.velo.apps.v1.page_imported_namespaces",method:"GET",methodFqn:"wix.velo.apps.analysis.v1.UserCodeImportedNamespaces.ListPagesImportedNamespaces",url:(n={protoPath:"/v1/apps/{gridAppId}/pages-imported-namespaces",data:a,host:i},X(Object.assign(n,{domainToMappings:{_:[{srcPath:"/_api/cloud-user-code-analyzer",destPath:""}],"www._base_domain_":[{srcPath:"/_api/cloud-user-code-analyzer",destPath:""}],"api._api_base_domain_":[{srcPath:"/cloud-user-code-analyzer",destPath:""}],"www.wixapis.com":[{srcPath:"/_api/cloud-user-code-analyzer",destPath:""}],"editor._base_domain_":[{srcPath:"/_api/cloud-user-code-analyzer",destPath:""}],"blocks._base_domain_":[{srcPath:"/_api/cloud-user-code-analyzer",destPath:""}],"create.editorx":[{srcPath:"/_api/cloud-user-code-analyzer",destPath:""}],"*.dev.wix-code.com":[{srcPath:"/_api/cloud-user-code-analyzer",destPath:""}]}}))),params:Z(a),transformResponse:o}}return i.fromReq=n,i.__isAmbassador=!0,i}(t),{signedInstance:r}).then((e=>e.data.pagesImportedNamespaces||[])).catch((e=>(console.error(e),[])))};function Pe(e){const t=e.appParams;if(l(t)){const{code:{gridId:e},metaSiteId:r}=m(t);return{metaSiteId:r,gridAppId:e}}if(f(t)){const e=t.appData.blocksPreviewData,{gridAppId:r,metaSiteId:n}=e;return{gridAppId:r,metaSiteId:n}}}const Ee=e=>{const t=Pe(e);return`${t?.gridAppId};${t?.metaSiteId}`},Se=async e=>{const t=(({wixCodeApi:e,appParams:t})=>"Site"!==e.window.viewMode&&f(t))(e)?ge.ModuleList:await(async e=>{const t=Pe(e);if(!t)return[];const r=e.wixCodeApi.window.warmupData.get(be);if(r)return r;const n=(await _e(e,t)).flatMap((({importedNamespaces:e})=>e)).map((e=>e?.name)).filter((e=>!!e&&ge.ModuleList.includes(e)));return e.wixCodeApi.window.warmupData.set(be,n),n})(e),r=[...new Set(t)].map((e=>e.replace("wix-",""))),{wixCodeApi:n}=e;return Object.fromEntries((await Promise.allSettled(r.map((async t=>{if(!n[t])return[t,await xe(t,e)]})))).filter((e=>"fulfilled"===e.status&&!!e.value&&null!==e.value[1])).map((e=>e.value)))},Oe=(0,c.memoize)(Se,Ee);var Ce={};function ke(e,t=!1,r=(e=>e)){return()=>({__type:"event-definition",type:e,isDomainEvent:t,transformations:r})}var Ie="wix_spi_error";const Te=e=>{switch(e){case"get":case"GET":return"GET";case"post":case"POST":return"POST";case"put":case"PUT":return"PUT";case"delete":case"DELETE":return"DELETE";case"patch":case"PATCH":return"PATCH";case"head":case"HEAD":return"HEAD";case"options":case"OPTIONS":return"OPTIONS";default:throw new Error(`Unknown method: ${e}`)}},Ae=e=>t=>async r=>{let n;const o=t=>{if(n=e(r)(t),void 0===n.url)throw new Error("Url was not successfully created for this request, please reach out to support channels for assistance.");const{method:o,url:i,params:a}=n;return{...n,method:Te(o),url:i,data:n.data,params:a}};try{const e=await t.request(o);if(void 0===n)throw new Error("Request options were not created for this request, please reach out to support channels for assistance.");const r=Array.isArray(n.transformResponse)?n.transformResponse:[n.transformResponse];let i=e.data;return r.forEach((t=>{t&&(i=t(e.data,e.headers))})),i}catch(e){if("object"==typeof e&&null!==e&&"response"in e&&"object"==typeof e.response&&null!==e.response&&"data"in e.response)throw e.response.data;throw e}},De=e=>{if(e.__isAmbassador)return!0;const t=e();return Boolean(t.__isAmbassador)},je="__metadata",Me="www.wixapis.com";class Ne extends Error{message;response;constructor(e,t){super(e),this.message=e,this.response=t}async details(){const e=await this.response.json();return $e(this.response.status,e?.message,e?.details,{requestId:this.response.headers.get("X-Wix-Request-Id"),details:e})}}const $e=(e,t,r,n)=>({details:{...!r?.validationError&&{applicationError:{description:t,code:e,data:n}},...r},message:t}),Fe=e=>e?.method&&["post","put","patch"].includes(e.method.toLocaleLowerCase())&&e.body?{"Content-Type":"application/json"}:{},Re=e=>e&&"object"==typeof e&&!Array.isArray(e);const We=e=>"host"===e.__type;const Le="x-wix-bi-gateway";function Ue(e){const t=globalThis.__wix_context__,r={client:Ce.client,elevatedClient:Ce.elevatedClient};let n;globalThis.__wix_context__=void 0,Ce.client=void 0,Ce.elevatedClient=void 0,"undefined"!=typeof $wixContext&&(n={client:$wixContext?.client,elevatedClient:$wixContext?.elevatedClient},delete $wixContext.client,delete $wixContext.elevatedClient);try{return e()}finally{globalThis.__wix_context__=t,Ce.client=r.client,Ce.elevatedClient=r.elevatedClient,"undefined"!=typeof $wixContext&&($wixContext.client=n.client,$wixContext.elevatedClient=n.elevatedClient)}}function Je(e,t,r,n,o,i,a){return Ue((()=>e({request:async e=>{const n=e({host:i?.HTTPHost||Me});let o=n;"GET"===o.method&&o.fallback?.length&&o.params.toString().length>4e3&&(o=n.fallback[0]);let s=`https://${i?.HTTPHost??Me}${o.url}`;o.params&&o.params.toString()&&(s+=`?${o.params.toString()}`);try{const e=function(e,t,r){return{[Le]:(n={environment:"js-sdk"+(r?`-${r}`:""),"package-name":e.packageName??t?.PACKAGE_NAME,"method-fqn":e.methodFqn,entity:e.entityFqdn},Object.entries(n).filter((([e,t])=>Boolean(t))).map((([e,t])=>`${e}=${t}`)).join(","))};var n}(n,t,a),i=await r(s,{method:o.method,...o.data&&{body:JSON.stringify(o.data)},headers:{...e}});if(200!==i.status){let e=null;try{e=await i.json()}catch(e){}throw qe(i.status,e?.message,e?.details,{requestId:i.headers.get("X-Wix-Request-Id"),details:e})}return{data:await i.json(),headers:i.headers,status:i.status,statusText:i.statusText}}catch(e){throw e.message?.includes("fetch is not defined")&&console.error("Node.js v18+ is required"),e}},fetchWithAuth:r,wixAPIFetch:n,getActiveToken:o})))}const qe=(e,t,r,n)=>({response:{data:{details:{...!r?.validationError&&{applicationError:{description:t,code:e,data:n}},...r},message:t},status:e}});function Be(){return{emit(e,...t){for(let r=0,n=this.events[e]||[],o=n.length;r<o;r++)n[r](...t)},events:{},on(e,t){return(this.events[e]||=[]).push(t),()=>{this.events[e]=this.events[e]?.filter((e=>t!==e))}}}}const He=e=>"event-definition"===e.__type;function ze(e,t,r,n){let o;if(e.isDomainEvent){const e=r,{deletedEvent:t,actionEvent:i,createdEvent:a,updatedEvent:s,...c}=e,d={...n,...c};o=t?t?.deletedEntity?{entity:t?.deletedEntity,metadata:d}:{metadata:d}:i?{data:i.body,metadata:d}:{entity:a?.entity??s?.currentEntity,metadata:d}}else o={data:r,metadata:n};return t((e.transformations??(e=>e))(o))}const Ge=e=>"service-plugin-definition"===e.__type;var Ve=i(932);async function Qe(e){const t=await fetch("https://www.wixapis.com/oauth2/token-info",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})});if(200!==t.status)throw new Error(`Failed to get token info. Unexpected status code from Wix OAuth API: ${t.status}`);return await t.json()}const Xe=e=>"web-method-module"===e.__type;var Ye;!function(e){e.Anyone="anyone",e.Admin="admin",e.SiteMember="site-member"}(Ye||(Ye={}));const Ke=/\/_webMethods\/(.+\..+)\/(.+\..+)/;const Ze="Error: Unable to handle the request. Contact the site administrator or view site monitoring logs for more information.";function et(){const e={};return{initModule(t){Object.assign(e,t)},client:{async processRequest(t,r=!1){const n=function(e){const t=e.match(Ke);if(t)return[t[1],t[2].replace(".ajax","")]}(t.url);if(!n)return new Response("invalid request",{status:400});const[o,i]=n,a=await t.json();if(!function(e){return!!e&&"object"==typeof e&&Array.isArray(e)}(a))return new Response("invalid request",{status:400});const s=e[`/${o}`];try{if(!s)throw new Error(`Error loading web module ${o}: Cannot find module '${o}'`);const e=(await s())[i];if(!e)throw new Error(`Error loading function from web module ${o}: function '${i}' not found`);return await async function(e,t){const r=e.headers.get("Authorization");if(!r)throw new Error("Request is missing authentication data");const{subjectType:n}=await Qe(r);switch(t){case Ye.Anyone:if("VISITOR"!==n&&"MEMBER"!==n&&"USER"!==n)throw new Error("Insufficient permissions");break;case Ye.SiteMember:if("MEMBER"!==n&&"USER"!==n)throw new Error("Insufficient permissions");break;case Ye.Admin:if("USER"!==n)throw new Error("Insufficient permissions")}}(t,e.permission),Response.json({result:await e.handler(...a)})}catch(e){const t=(0,Ve.serializeError)(e,{maxDepth:1});return Response.json({result:!r&&e instanceof Error?{...t,message:Ze,stack:Ze}:t,exception:!0})}}}}}function tt(e){const t=e.headers||{Authorization:""},r=e.auth||{getAuthHeaders:e=>Promise.resolve({headers:{}})},n=r.getAuthHeaders.bind(void 0,e.host);r.getAuthHeaders=n;const{client:o,initModule:i}=function(e){const t=new Map,r=Be();return{initModule:e=>n=>{const o=t.get(e.componentType.toLowerCase())??[];o.push({servicePluginDefinition:e,implementation:n}),t.set(e.componentType.toLowerCase(),o),r.emit("registered",e)},client:{...r,getRegisteredServicePlugins:()=>t,async parseJWT(t){if(!e.decodeJWT)throw new Error("decodeJWT is not supported by the authentication strategy");const{decoded:r,valid:n}=await e.decodeJWT(t,!0);if(!n)throw new Error("JWT is not valid");if("object"!=typeof r.data||null===r.data||!("metadata"in r.data)||"object"!=typeof r.data.metadata||null===r.data.metadata||!("appExtensionType"in r.data.metadata)||"string"!=typeof r.data.metadata.appExtensionType)throw new Error("Unexpected JWT data: expected object with metadata.appExtensionType string");return r.data},async process(e){const t=await this.parseJWT(e.body);return this.executeHandler(t,e.url)},async parseRequest(e){const t=await e.text();return this.parseJWT(t)},async processRequest(e){const t=e.url,r=await e.text();try{const e=await this.process({url:t,body:r});return Response.json(e)}catch(e){if("SPI"===e.errorType&&e.applicationCode&&e.httpCode)return Response.json({applicationError:{code:e.applicationCode,data:e.data}},{status:e.httpCode});throw e}},async executeHandler(e,r){const n=e.metadata.appExtensionType.toLowerCase(),o=t.get(n)??[];if(0===o.length)throw new Error(`No service plugin implementations found for component type ${n}`);if(o.length>1)throw new Error(`Multiple service plugin implementations found for component type ${n}. This is currently not supported`);const{implementation:i,servicePluginDefinition:a}=o[0],s=a.methods.find((e=>r.endsWith(e.primaryHttpMappingPath)));if(!s)throw new Error("Unexpect request: request url did not match any method: "+r);const c=i[s.name];if(!c)throw new Error(`Got request for service plugin method ${s.name} but no implementation was provided. Available methods: ${Object.keys(i).join(", ")}`);return s.transformations.toREST(await c(s.transformations.fromREST(e)))}}}}(r),{client:a,initModule:s}=function(e){const t=new Map,r=Be();return{initModule:e=>n=>{const o=t.get(e.type)??[];o.push({eventDefinition:e,handler:n}),t.set(e.type,o),r.emit("registered",e)},client:{...r,getRegisteredEvents:()=>t,async process(e,r={expectedEvents:[]}){const{eventType:n,identity:o,instanceId:i,payload:a}=await this.parseJWT(e),s=[...r.expectedEvents,...Array.from(t.keys()).map((e=>({type:e})))];if(s.length>0&&!s.some((({type:e})=>e===n)))throw new Error(`Unexpected event type: ${n}. Expected one of: ${s.map((e=>e.type)).join(", ")}`);const c=t.get(n)??[];return await Promise.all(c.map((({eventDefinition:e,handler:t})=>ze(e,t,a,{instanceId:i,identity:o})))),{instanceId:i,eventType:n,payload:a,identity:o}},async processRequest(e,t){const r=await e.text();return this.process(r,t)},async parseJWT(t){if(!e.decodeJWT)throw new Error("decodeJWT is not supported by the authentication strategy");const{decoded:r,valid:n}=await e.decodeJWT(t);if(!n)throw new Error("JWT is not valid");if("string"!=typeof r.data)throw new Error("Unexpected type of JWT data: expected string, got "+typeof r.data);const o=JSON.parse(r.data),i=o.eventType,a=o.instanceId,s=o.identity?JSON.parse(o.identity):void 0;return{instanceId:a,eventType:i,payload:JSON.parse(o.data),identity:s}},async parseRequest(e){const t=await e.text();return this.parseJWT(t)},async executeHandlers(e){const r=Array.from(t.keys()).map((e=>({type:e})));if(r.length>0&&!r.some((({type:t})=>t===e.eventType)))throw new Error(`Unexpected event type: ${e.eventType}. Expected one of: ${r.map((e=>e.type)).join(", ")}`);const n=t.get(e.eventType)??[];await Promise.all(n.map((({eventDefinition:t,handler:r})=>ze(t,r,e.payload,{instanceId:e.instanceId,identity:e.identity}))))},apps:{AppInstalled:ke("AppInstalled")(),AppRemoved:ke("AppRemoved")()}}}}(r),{client:c,initModule:d}=et(),u=async(r,o)=>{const i=await n(),a=Fe(o);return fetch(r,{...o,headers:{...a,...t,...i?.headers,...o?.headers,...e.host?.essentials?.passThroughHeaders}})},p=(t,n)=>{if(He(t))return s(t);if(Ge(t))return i(t);if(We(t)&&e.host)return o=t,a=e.host,o.create(a);if(Xe(t))return d(t);if("function"==typeof t){if("__type"in t&&t.__type===Ie)return t;const o=e.host?.apiBaseUrl??Me;return Je(Ue((()=>De(t)))?Ae(t):t,n??{},u,((e,t)=>{const r=new URL(e,`https://${o}`);return r.host=o,r.protocol="https",u(r.toString(),t)}),r.getActiveToken,{HTTPHost:o},e.host?.name)}return Re(t)?Object.fromEntries(Object.entries(t).map((([e,r])=>[e,p(r,t[je])]))):t;var o,a};return{...e.modules?p(e.modules):{},auth:r,setHeaders:e=>{for(const r in e)t[r]=e[r]},use:p,enableContext(e,t={elevated:!1}){"global"===e?null!=globalThis.__wix_context__?t.elevated?globalThis.__wix_context__.elevatedClient=this:globalThis.__wix_context__.client=this:t.elevated?globalThis.__wix_context__={elevatedClient:this}:globalThis.__wix_context__={client:this}:t.elevated?Ce.elevatedClient=this:Ce.client=this},fetch:(t,r)=>{const n=e.host?.apiBaseUrl??Me,o=new URL(t,`https://${n}`);return o.host=n,o.protocol="https",u(o.toString(),r)},fetchWithAuth:async(e,t)=>{if("string"==typeof e||e instanceof URL)return fetch(e,{...t,headers:{...t?.headers,...(await n()).headers}});for(const[t,r]of Object.entries((await n()).headers))e.headers.set(t,r);return fetch(e,t)},async graphql(t,r,n={apiVersion:"alpha"}){const o=e?.host?.apiBaseUrl??Me,i=await u(`https://${o}/graphql/${n.apiVersion}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t,variables:r})});if(200!==i.status)throw new Ne(`GraphQL request failed with status ${i.status}`,i);const{data:a,errors:s}=await i.json();return{data:a??{},errors:s}},webhooks:a,webMethods:c,servicePlugins:o}}const rt=e=>{let{clientSdk:t,applicationId:r}=e;return{invoke:async e=>{let{namespace:n,method:o,args:i}=e;if(!t)throw new Error("Wix Site SDK only works in a Wix site environment. Learn more: https://dev.wix.com/docs/sdk/host-modules/site/introduction");return t.invoke({namespace:n,method:o,args:i,applicationId:r,accessToken:"accessToken"})},getAccessToken:()=>{throw new Error("Not implemented")},observeState:()=>({disconnect:()=>{}})}},nt=(e=>{let{createHost:t}=e;return{__type:"host",create:e=>({}),host:e=>{var r,n;return{...t(e),apiBaseUrl:function(){const e="undefined"!=typeof window?window.wixEmbedsAPI:void 0,t=null==e||null==e.getExternalBaseUrl?void 0:e.getExternalBaseUrl();if(!t)return;const r=new URL(t);if(null!=r&&r.pathname&&"/"!==r.pathname)return""+r.hostname+r.pathname;return r.hostname}(),essentials:{language:"undefined"!=typeof window?null==(r=window.commonConfig)?void 0:r.language:void 0,locale:"undefined"!=typeof window?null==(n=window.commonConfig)?void 0:n.locale:void 0}}},auth:e=>{const t="undefined"!=typeof window?window.wixEmbedsAPI:void 0;e||(e=null==t||null==t.getAccessTokenFunction?void 0:t.getAccessTokenFunction());let r=!1;const{resolve:n,promise:o}=function(){let e=null,t=null;return{promise:new Promise(((r,n)=>{e=r,t=n})),resolve:e,reject:t}}();return{getAuthHeaders:async()=>{if(!e&&r&&(e=await o),!e)throw new Error("Failed to resolve auth token");return{headers:{Authorization:await e()}}},getAccessTokenInjector:()=>(r=!0,e=>{n(e)})}}}})({createHost:function(e){const t="undefined"!=typeof $wixContext&&$wixContext.clientSdk||(null==e?void 0:e.clientSdk)||window.clientSdk,{applicationId:r}=e||{};if(!r)throw new Error('"createHost" was called without a required field "applicationId"');return{channel:rt({clientSdk:t,applicationId:r}),close:()=>{}}}}),ot=e=>({async invoke({applicationId:t,namespace:r,method:n,args:o}){try{const t=(0,c.get)(e,`${r}.${n}`);return"function"==typeof t?(0,c.invoke)(e,`${r}.${n}`,...o):t}catch(e){console.error("Wix SDK- Failed to invoke method",{applicationId:t,namespace:r,method:n,message:e.message})}}});function it(e,t,r){const n=ot(e),o=function(e){if("Site"!==e.window?.viewMode)return;const t=e.location?.baseUrl;return new URL(t).hostname}(e);return{client:tt({host:{...nt.host({applicationId:t,clientSdk:n}),...void 0!==o?{apiBaseUrl:o}:{},essentials:{language:e.window?.multilingual?.currentLanguage||e.site?.language,locale:e.window?.locale}},auth:{getAuthHeaders:()=>({headers:{Authorization:r.startsWith("OauthNG")?r:e.elementorySupport?.getRequestOptions().Authorization}})}}),clientSdk:n}}const at=async(e,t=!1)=>{const{$w:r,wixCodeApi:n,platformAPIs:o}=e,i=await Oe(e),a=function(e,t,r){const n=he(e,t,r),o=self.fetch.bind(self);return(0,q.buildNamespacesMap)(n,o)}({...n,...i},o,e),s=n.telemetry?.console??console,c=(e=>{const t=e.appParams.blocksData?.packageImportName;if(t)return e=>(0,U.et)(t,e)})(e);e?.wixCodeApi?.elementorySupport?.setHeader("x-wix-app-instance",e.appParams.instance);const d=t?function(e,t,r){const{client:n,clientSdk:o}=it(e,t,r);return{version:3,client:n,clientSdk:o}}(n,e.appParams.appDefinitionId,e.appParams.instance):void 0;return{$w:r,$ns:a,console:s,elementorySupport:n.elementorySupport,getAppDefIdFromPackageName:(u=e.appParams.codePackagesData,e=>{const t=u?.find((({importName:t})=>(0,U.C9)(t)===e));return t?.appDefId??null}),generateWebMethodUrl:c,...d?{$wixContext:d,wixClient:d.client}:{}};var u};function st(e,t){const r=function(e){return"connections"in e&&Array.isArray(e.connections)?e.connections.map((t=>e.$w("#"+t.role))).filter((e=>function(e){return"initWidgetDataSource"in e&&"function"==typeof e.initWidgetDataSource}(e))):[]}(e);r.forEach((e=>{e.initWidgetDataSource({getData:()=>t.props,onDataChanged:e=>t.onPropsChanged(((t,r)=>e(t,r)))})}))}async function ct(e,r,n){return L(e,r,(async o=>{const{$widget:i,config:a}=o;e.appParams.blocksData?.packageImportName&&self.elementorySupport&&function(e,t){if(t?.options?.headers?.["x-wix-site-revision"])return;const{revision:r}=e.wixCodeApi.site;try{t.options=t.options??{},t.options.headers=t.options.headers??{},t.options.headers["x-wix-site-revision"]=r}catch(e){console.error("failed adding elementory support headers",e)}}(e,self.elementorySupport),(e=>{if(!e?.wixCodeApi?.location?.url)return!1;const t=new URL(e?.wixCodeApi?.location?.url),r=t.searchParams.get("sdkVersion"),n=t.searchParams.get("componentRef");return null!==r&&null!==n})(o)&&(o.appParams.instance=await(o.wixCodeApi.editor?.getAppInstance())||o.appParams.instance);const s=await at(e,t.isOpen("specs.wb.loadWidgetModuleCodeUsingWixContext")),c=await function({widgetModule:e,$w:t,$widget:r,$ns:n,console:o,elementorySupport:i,getAppDefIdFromPackageName:a,generateWebMethodUrl:s,$wixContext:c,wixClient:d}){return e?e({$w:t,$widget:r,$ns:n,console:o,elementorySupport:i,getAppDefIdFromPackageName:a,generateWebMethodUrl:s,...c?{$wixContext:c}:{},...d?{wixClient:d}:{}}):Promise.resolve({})}({...s,widgetModule:n,$widget:i});return{pageReady(t){const n=r?.behaviors??a.behaviors??[];st(e,i),n.forEach((({role:e,event:r,callbackId:n})=>{!function(e,t,r,n,o){const i=o[n];if(!i)return;const a=e(`@${t}`)[r];a?a(i):console.error(`tried registering to invalid event ${r}`)}(t,e,r,n,c)}))},exports:r.functions?.reduce(((e,{name:t})=>(c[t]&&(e[t]=c[t]),e)),{})||{}}}),{shouldAddInternalApi:!1})}class dt extends o{constructor(e,t){super(`Failed to import user code script: ${e.message}`),this.name="UserCodeNetworkError",this.originalError=e,this.url=t}}const ut=e=>{try{return(e=>{let t;const r=self.define,n=function(e,r){t=r};n.amd=!0,self.define=n;try{return self.importScripts(e),t}catch(t){if(t&&(t.name===le||t.name===fe))throw new dt(t,e);throw t}finally{r?self.define=r:delete self.define}})(e)}catch(e){return()=>{throw e}}};class pt{constructor(e,t){this._widgetModuleStore={},this._blocksConfig=t?.blocksConfig??m(e)}getModule(e){const t=y(e,this._blocksConfig);return this._widgetModuleStore[t]||(this._widgetModuleStore[t]=ut(t)),this._widgetModuleStore[t]}}class lt{constructor(e,t,r=new pt(e)){this._metaDataProvider=t,this._widgetModuleProvider=r}async loadWidget(e){const t=e.config.type,r=this._widgetModuleProvider.getModule(t);return ct(e,await this._metaDataProvider.getMetaData(t),r)}}var ft;!function(e){e[e.BundledCodeModuleProvider=0]="BundledCodeModuleProvider",e[e.AMDModuleProvider=1]="AMDModuleProvider",e[e.DefaultModuleProvider=2]="DefaultModuleProvider"}(ft||(ft={}));class mt{constructor(e){!function(e){if(!l(e.appParams)||!e.appParams.appData?.blocksConsumerData.widgetBundleUrls)throw new Error("not blocks app params with widget bundle urls")}(e),function(e){if(!e)throw new Error("missing wix code apis")}(e.wixCodeApi),this._widgetBundleUrls=e.appParams.appData.blocksConsumerData.widgetBundleUrls}getModule(e){const t=this._widgetBundleUrls[e];return async e=>{const{init:r}=await(async e=>{try{return await import(e)}catch(t){throw new dt(t,e)}})(t);return r({...e,wixClient:e.$wixContext?.client})}}}class wt{constructor(e,t){this.controllerConfig=e,this._blocksConfig=t?.blocksConfig??m(e.appParams)}getModule(e){const t=y(e,this._blocksConfig);return e=>(function(e){if(!e.environment?.network.importAMDModule)throw new Error("importAMDModule is not defined")}(this.controllerConfig.wixCodeApi),this.controllerConfig.wixCodeApi.environment.network.importAMDModule(t,{globals:e}))}}const ht=(e,t)=>{switch(gt(e)){case ft.BundledCodeModuleProvider:return new mt(e);case ft.AMDModuleProvider:return new wt(e,{blocksConfig:t});case ft.DefaultModuleProvider:return new pt(e.appParams,{blocksConfig:t})}},gt=e=>{var r,n;return t.isOpen("specs.blocks-client.useBundledWidgetCode")&&l(e.appParams)&&null!=(r=e.appParams.appData)&&r.blocksConsumerData.widgetBundleUrls?ft.BundledCodeModuleProvider:null!=(n=e.wixCodeApi.environment)&&n.network.importAMDModule?ft.AMDModuleProvider:ft.DefaultModuleProvider},vt=(e,t)=>{var r;let{logger:n}=t;const{appParams:o,platformAPIs:i}=e[0];if((e=>{var t;return!(null!=(t=e.baseUrls)&&t.siteAssets||!e.blocksData)})(o)&&null!=(r=i.bi)&&r.metaSiteId)return console.info("Loading legacy blocks app"),((e,t,r,n)=>{let{logger:o}=n;const i=((e,t)=>{var r;const{wixCodeInstanceId:n,wixCodeGridId:o}=e.blocksData;return{appDefinitionId:e.appDefinitionId,code:{instanceId:n,gridId:o,experimentsQueryString:(null==(r=e.appData)||null==(r=r.blocksConsumerData)?void 0:r.codeExperimentsQueryString)||""},metaSiteId:t,revision:`legacy-${o}`}})(t,r),a=new D(t,e,{logger:o,blocksConfig:i}),s=ht(e[0],i);return new lt(t,a,s)})(e,o,i.bi.metaSiteId,{logger:n});const a=new D(o,e,{logger:n}),s=ht(e[0]);return new lt(o,a,s)},yt={pageReady(){},exports:()=>({})};const{initAppForPage:bt,createControllers:xt}=function(){const n=new Map,o=(e,t)=>{t.interactionStarted(r.INTERACTIONS.CREATE_CONTROLLERS);const n=vt(e,{logger:t}),o=e.map((async e=>{try{const o=e.config.devCenterWidgetId,{appDefinitionId:i}=e.appParams;t.interactionStarted(`${r.PHASES.LOAD_WIDGET}_${o}`),t.appPhaseStarted(r.PHASES.LOAD_WIDGET,{appId:i,widgetId:o});const a=await n.loadWidget(e);return t.appPhaseEnded(r.PHASES.LOAD_WIDGET,{appId:i,widgetId:o}),t.interactionEnded(`${r.PHASES.LOAD_WIDGET}_${o}`),a}catch(e){return t.reportError("Failed loading widget",e),yt}}));return Promise.all(o).then((()=>{t.interactionEnded(r.INTERACTIONS.CREATE_CONTROLLERS),t.appLoadEnded()})),o};return{initAppForPage:async(o,i,a,s)=>{var c;const{appDefinitionId:d}=o,u=new e;u.init(s,{appDefId:r.APP_DEF_ID,errorMonitorOptions:{dsn:r.SENTRY.DSN,environment:"production",version:"a559fa67119ab32b28898a1fb681b4176b2b89f3e907408fdaa42aec",appName:"blocks-client-viewer-app",tags:{appDefId:d,...e.getCommonTags(s)}},fedOps:{interactionPrefix:r.LOGGER.PREFIX}}),u.appLoadStarted(),n.set(d,u),await t.init({scope:r.EXPERIMENTS_SCOPE,wixCodeApi:a,platformServicesAPI:s,preloadedExperiments:null==(c=o.appData)||null==(c=c.blocksConsumerData)?void 0:c.experiments,logger:u})},createControllers:e=>{if(0===e.length)return[];const{appParams:t}=e[0],r=n.get(t.appDefinitionId);if(!r)throw new Error("Failed to initialize Blocks app");return r.wrapWithErrorReporter(o,"Failed running create controllers")(e,r)}}}()})(),a})()));
//# sourceMappingURL=viewerApp.umd.min.js.map
//# sourceURL=https://static.parastorage.com/services/blocks-client-viewer-app/1.2311.0/viewerApp.umd.min.js